
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tratamiento de datos. &#8212; Programación Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Manipulación de cadenas de texto." href="Lectura_8_procesamientoDeCadenasDeTexto.html" />
    <link rel="prev" title="Operaciones básicas con dataframes" href="Lectura_6.1_operacionesB%C3%A1sicasDataframes.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo_python.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programación Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introducción al book.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Clases_Python.html">
   Clases en
   <code class="docutils literal notranslate">
    <span class="pre">
     Python
    </span>
   </code>
   (En construcción)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_1_Intro_Markdown.html">
   Introducción a los notebooks y al lenguaje Markdown
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_2_elementos_basicos_Python.html">
   Introducción a Python - elementos básicos del lenguaje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_3_Defi_Function_Python.html">
   Funciones en Python.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_4_estruc_Datos_Python.html">
   Estructuras de datos en python.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_5_Pandas_Series_DataFrame.html">
   Introducción Libreria
   <code class="docutils literal notranslate">
    <span class="pre">
     Pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_6.0_Mas_de_Pandas.html">
   Más sobre la libreria
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_6.1_operacionesB%C3%A1sicasDataframes.html">
   Operaciones básicas con dataframes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Tratamiento de datos.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_8_procesamientoDeCadenasDeTexto.html">
   Manipulación de cadenas de texto.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lectura_12_Intro_Plotly.html">
   Introducción a la librería
   <code class="docutils literal notranslate">
    <span class="pre">
     Plotly
    </span>
   </code>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Lectura_7_CruceDatos_TratamientoInformación.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FLectura_7_CruceDatos_TratamientoInformación.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Lectura_7_CruceDatos_TratamientoInformación.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cruce-de-informacion">
   <em>
    Cruce de información.
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uniones-joins">
     <em>
      Uniones (Joins)
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-infomacion-archivo-de-excel-examen2-xlsx">
     <em>
      Ejemplo: Infomación archivo de Excel
      <code class="docutils literal notranslate">
       <span class="pre">
        examen2.xlsx
       </span>
      </code>
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#informacion-del-archivo-examen2-xlsx">
     Información del archivo
     <code class="docutils literal notranslate">
      <span class="pre">
       examen2.xlsx
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#actividad-1-cargar-informacion-del-examen">
     <em>
      Actividad 1: Cargar información del examen
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ejercicio-1">
       <em>
        Ejercicio 1.
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#actividad-2-preguntas-que-se-pueden-responder-con-estos-datos">
     Actividad 2. Preguntas que se pueden responder con estos datos
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solucion-pregunta-1">
       <strong>
        Solución pregunta 1
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#resolver-pregunta-1">
       Resolver Pregunta 1.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solucion-pregunta-2">
       <strong>
        Solución pregunta 2
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-pregunta-3">
     <em>
      <strong>
       Solución pregunta 3
      </strong>
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#agrupar-datos-con-el-metodo-groupby">
   Agrupar datos con el método
   <em>
    groupby
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resumen-de-funciones-para-trabajar-con-series-numericas-en-pandas">
     <strong>
      Resumen de funciones para trabajar con series numéricas en pandas:
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplos-de-groupby-con-examen2-xlsx">
     Ejemplos de groupby con
     <em>
      examen2.xlsx
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <em>
      <strong>
       Solución pregunta 3.
      </strong>
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-de-la-pregunta-4">
     <em>
      <strong>
       Solución de la pregunta 4
      </strong>
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-pregunta-5">
     <em>
      <strong>
       Solución pregunta 5.
      </strong>
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#manejo-de-tablas-pivote">
   <em>
    <strong>
     Manejo de Tablas Pivote
    </strong>
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#el-metodo-pivot-table">
     El método:
     <code class="docutils literal notranslate">
      <span class="pre">
       pivot_table
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-pivot-table-1">
     Ejemplo pivot_table 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uso-de-pivot-table">
     Uso de pivot_table
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-pivot-table-2">
     Ejemplo pivot table 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicios">
   <em>
    <strong>
     Ejercicios.
    </strong>
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tarea-revisar">
   Tarea: revisar:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manejo-de-datos-duplicados">
     1. Manejo de datos duplicados
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manejo-de-datos-perdidos-o-esperados">
     2. Manejo de datos perdidos o esperados
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Tratamiento de datos.</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cruce-de-informacion">
   <em>
    Cruce de información.
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uniones-joins">
     <em>
      Uniones (Joins)
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-infomacion-archivo-de-excel-examen2-xlsx">
     <em>
      Ejemplo: Infomación archivo de Excel
      <code class="docutils literal notranslate">
       <span class="pre">
        examen2.xlsx
       </span>
      </code>
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#informacion-del-archivo-examen2-xlsx">
     Información del archivo
     <code class="docutils literal notranslate">
      <span class="pre">
       examen2.xlsx
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#actividad-1-cargar-informacion-del-examen">
     <em>
      Actividad 1: Cargar información del examen
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ejercicio-1">
       <em>
        Ejercicio 1.
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#actividad-2-preguntas-que-se-pueden-responder-con-estos-datos">
     Actividad 2. Preguntas que se pueden responder con estos datos
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solucion-pregunta-1">
       <strong>
        Solución pregunta 1
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#resolver-pregunta-1">
       Resolver Pregunta 1.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solucion-pregunta-2">
       <strong>
        Solución pregunta 2
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-pregunta-3">
     <em>
      <strong>
       Solución pregunta 3
      </strong>
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#agrupar-datos-con-el-metodo-groupby">
   Agrupar datos con el método
   <em>
    groupby
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resumen-de-funciones-para-trabajar-con-series-numericas-en-pandas">
     <strong>
      Resumen de funciones para trabajar con series numéricas en pandas:
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplos-de-groupby-con-examen2-xlsx">
     Ejemplos de groupby con
     <em>
      examen2.xlsx
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <em>
      <strong>
       Solución pregunta 3.
      </strong>
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-de-la-pregunta-4">
     <em>
      <strong>
       Solución de la pregunta 4
      </strong>
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-pregunta-5">
     <em>
      <strong>
       Solución pregunta 5.
      </strong>
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#manejo-de-tablas-pivote">
   <em>
    <strong>
     Manejo de Tablas Pivote
    </strong>
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#el-metodo-pivot-table">
     El método:
     <code class="docutils literal notranslate">
      <span class="pre">
       pivot_table
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-pivot-table-1">
     Ejemplo pivot_table 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uso-de-pivot-table">
     Uso de pivot_table
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-pivot-table-2">
     Ejemplo pivot table 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicios">
   <em>
    <strong>
     Ejercicios.
    </strong>
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tarea-revisar">
   Tarea: revisar:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manejo-de-datos-duplicados">
     1. Manejo de datos duplicados
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manejo-de-datos-perdidos-o-esperados">
     2. Manejo de datos perdidos o esperados
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="tratamiento-de-datos">
<h1>Tratamiento de datos.<a class="headerlink" href="#tratamiento-de-datos" title="Permalink to this headline">#</a></h1>
<p><strong>Tema:</strong></p>
<ul class="simple">
<li><p>Cruce de información - merge</p></li>
<li><p>Agrupamiento de categorías - groupby</p></li>
<li><p>Tablas pivote: cruzar categorías de filas y columnas.</p></li>
</ul>
<section id="cruce-de-informacion">
<h2><em>Cruce de información.</em><a class="headerlink" href="#cruce-de-informacion" title="Permalink to this headline">#</a></h2>
<p>El cruce de información es una operación esencial en el análisis de los datos. Usualmente, la posibilidad de realizar el cruce de dos o más fuentes de información es el primer paso para responder preguntas complejas acerca de los datos. Existen muchas formas de cruzar o combinar tablas de datos. El cruce de estos datos siempre tiene un propósito. Por tanto, se debe realizar un análisis de lo que se requiere antes de iniciar. Para esto, lo primero es conocer bien las fuentes de información que se van a relacionar.</p>
<section id="uniones-joins">
<h3><em>Uniones (Joins)</em><a class="headerlink" href="#uniones-joins" title="Permalink to this headline">#</a></h3>
<p>Usando la librería pandas se pueden realizar 4 tipos de uniones para cruzar información entre dos fuentes de datos, ver Figura abajo.</p>
<ul class="simple">
<li><p>INNER JOIN: este tipo de cruce incluye solo los registros que coincieden en las dos tablas.</p></li>
<li><p>LEFT JOIN:  en este tipo de cruce se incluyen todos los registros de la primera tabla aunque no aparezcan coincidencias en la segunda. Cuando no hay coincidencias en la segunda tabla los campos correspondientes a esta aparecerán como nulos.</p></li>
<li><p>RIGHT JOIN: en este tipo de cruce se incluyen todos los registros de la segunda tabla aunque no aparezcan coincidencias en la primera. Cuando no hay coincidencias en la primer tabla los campos correspondientes a esta aparecerán como nulos.</p></li>
<li><p>OUTER JOIN O FULL JOIN: combina todos los registros de ambas tablas aunque no existan coincidencias en la otra tabla.</p></li>
</ul>
<p><img alt="Los tipos de uniones que se pueden ejecutar en pandas" src="https://letsdobigdata.files.wordpress.com/2016/03/joins.png" /></p>
<p><strong>Imagen tomada de <a class="reference external" href="http://wordpress.com">wordpress.com</a></strong></p>
<p>La combinación a usar depende del análisis que se requiera con los datos. Lo más común es realizar un cruce de tipo Inner Join, debido a que muestra los registros cuando aparecen relacionados en ambas tablas. Sin embargo, en
ocasiones se quiere saber que pasa con todos los registros de la primera tabla aunque no se tengan coincidencias. Alternativamente, quizá, lo menos usual es hacer combinaciones de tipo RIGHT o OUTER. Generalmente, estas son usadas cuando se quiere saber por qué no se tienen coincidencias, o cuáles registros no cumplen con la relación especificada.</p>
</section>
<section id="ejemplo-infomacion-archivo-de-excel-examen2-xlsx">
<h3><em>Ejemplo: Infomación archivo de Excel <code class="docutils literal notranslate"><span class="pre">examen2.xlsx</span></code></em><a class="headerlink" href="#ejemplo-infomacion-archivo-de-excel-examen2-xlsx" title="Permalink to this headline">#</a></h3>
<p>Para entender como funciona se necesita una tabla de inofrmación. Para esto, se va utilizar el archivo <code class="docutils literal notranslate"><span class="pre">examen2.xlsx</span></code>. Este archivo consta de seis tablas repartidas en diferentes hojas del libro de excel. El archivo contiene el registro anonimizado del examen de algoritmos y programación aplicado a todos los programas de Ingeniería en 2017-2. La información recolectada registró los resultados del examen de los estudiantes de la asignatura “algoritmos y programación” en el mencionado periodo académico. A este registro lo acompañan una tabla de los profesores y otra tabla de los grupos de cursos que se formaron. Además, se tiene un informe de calificaciones de los estudiantes antes de presentar dicho examen, referente a notas y fallas del primer y segundo corte. Finalmente, se cuenta con un registro de la citación al examen de cada estudiante. Para mayor claridad, a continuación se describe en detalle los sheets:</p>
</section>
<section id="informacion-del-archivo-examen2-xlsx">
<h3>Información del archivo <code class="docutils literal notranslate"><span class="pre">examen2.xlsx</span></code><a class="headerlink" href="#informacion-del-archivo-examen2-xlsx" title="Permalink to this headline">#</a></h3>
<p>ESTUDIANTE</p>
<ul class="simple">
<li><p><strong>IDE:</strong> identificador de estudiante (valor entero consecutivo)</p></li>
<li><p><strong>programa:</strong> programa al que pertenece (texto {Ingeniería de sistemas, Ingeniería ambiental, Ingeniería mecánica, Ingeniería electrónica, Ingeniería industrial})</p></li>
<li></li>
</ul>
<p>PROFESOR</p>
<ul class="simple">
<li><p><strong>IDP:</strong> identificador de profesor (valor entero consecutivo)</p></li>
<li><p><strong>profesor:</strong> nombre del profesor (texto)</p></li>
<li><p><strong>dedicación:</strong> dedidcación de profesor en la U {TC, TM y Cátedra}</p></li>
<li></li>
</ul>
<p>GRUPO</p>
<ul class="simple">
<li><p><strong>IDG:</strong> número del grupo (texto, consecutivo del grupo)</p></li>
<li><p><strong>curso:</strong> nombre del curso (texto)</p></li>
<li><p><strong>creditos:</strong> número de créditos del curso (número entero positivo)</p></li>
<li><p><strong>nestd:</strong> número de estudiantes inscritos en cada grupo (entero positivo)</p></li>
<li><p><strong>periodo:</strong> periodo académico del año en que se dictó el curso {1,2, 3}</p></li>
<li><p><strong>año:</strong>  año en que se dictó el curso (entero positivo)</p></li>
</ul>
<p>LISTADO</p>
<ul class="simple">
<li><p><strong>corte1:</strong> nota en el primer corte (valor real [0.0, 5.0])</p></li>
<li><p><strong>corte2:</strong> nota en el segundo corte (valor real [0.0, 5.0])</p></li>
<li><p><strong>prom:</strong> promedio primeros dos cortes (valor real [0.0, 5.0])</p></li>
<li><p><strong>fallas:</strong> cantidad de horas de falla (valor entero mayor o igual a cero)</p></li>
<li><p><strong>fallaP:</strong> porcentaje de horas de falla (real [0.0, 100.0])</p></li>
</ul>
<p>EXAMEN</p>
<ul class="simple">
<li><p><strong>inicio:</strong> hora inicio de examen (hora formato: ‘%H%M’)</p></li>
<li><p><strong>final:</strong> hora finalización de examen (hora formato: ‘%H%M’)</p></li>
<li><p><strong>nota:</strong> nota total (valor real [0.0, 5.0])</p></li>
<li><p><strong>p1, p2,…,p10:</strong> resultado por pregunta, 10 preguntas (valor real [0.0, 5.0])</p></li>
</ul>
<p>CITA</p>
<ul class="simple">
<li><p><strong>nsala:</strong> número de la sala en donde presenta el examen (valor entero consecutivo)</p></li>
<li><p><strong>sala:</strong>  nombre de la sala en donde presenta el examen (texto)</p></li>
<li><p><strong>horaExamen:</strong> hora programada para presentar examen (hora formato: ‘%H%M %pm’)</p></li>
<li><p><strong>jornada:</strong> jornada en la que presenta el examen (texto {día, noche})</p></li>
</ul>
</section>
<section id="actividad-1-cargar-informacion-del-examen">
<h3><em>Actividad 1: Cargar información del examen</em><a class="headerlink" href="#actividad-1-cargar-informacion-del-examen" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Para esto se debe incluir la librería <code class="docutils literal notranslate"><span class="pre">pandas</span></code> y se recomienda importar la librería <code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></li>
<li><p>Definir una ruta y nombre del recurso (url del archivo).</p></li>
<li><p>Crear un DataFrame con cualquier tabla de las que estas disponibles en el recurso.</p></li>
</ol>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar las librerías básicas </span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># celda de código para probar</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<section id="ejercicio-1">
<h4><em>Ejercicio 1.</em><a class="headerlink" href="#ejercicio-1" title="Permalink to this headline">#</a></h4>
<p>Cargue todas las hojas del libro en diferentes dataframes y explore la información. Compare las columnas de los dataframes con el diccionario de datos presentado arriba</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total 2456
drwxrwxr-x 5 andres-campos andres-campos   4096 ago  4 12:03 <span class=" -Color -Color-Bold -Color-Bold-Blue">_build</span>/
-rw-rw-r-- 1 andres-campos andres-campos   9205 ago  4 12:03 Clases_Python.ipynb
-rw-rw-r-- 1 andres-campos andres-campos   1121 ago  4 12:03 _config.yml
drwxrwxr-x 5 andres-campos andres-campos   4096 ago  4 12:03 <span class=" -Color -Color-Bold -Color-Bold-Blue">datas</span>/
-rw-rw-r-- 1 andres-campos andres-campos      0 ago  4 12:03 hello.txt
-rw-rw-r-- 1 andres-campos andres-campos    754 ago  4 12:03 intro.md
-rw-rw-r-- 1 andres-campos andres-campos 593599 ago  4 12:03 Lectura_12_Intro_Plotly.ipynb
-rw-rw-r-- 1 andres-campos andres-campos  12578 ago  4 12:03 Lectura_1_Intro_Markdown.ipynb
-rw-rw-r-- 1 andres-campos andres-campos  74882 ago  4 12:03 Lectura_2_elementos_basicos_Python.ipynb
-rw-rw-r-- 1 andres-campos andres-campos 219115 ago  4 12:03 Lectura_3_Defi_Function_Python.ipynb
-rw-rw-r-- 1 andres-campos andres-campos  74751 ago  4 12:03 Lectura_4_estruc_Datos_Python.ipynb
-rw-rw-r-- 1 andres-campos andres-campos  48871 ago  4 12:03 Lectura_5_Pandas_Series_DataFrame.ipynb
-rw-rw-r-- 1 andres-campos andres-campos 212741 ago  4 12:03 Lectura_6.0_Mas_de_Pandas.ipynb
-rw-rw-r-- 1 andres-campos andres-campos 709101 ago  4 12:03 Lectura_6.1_operacionesBásicasDataframes.ipynb
-rw-rw-r-- 1 andres-campos andres-campos 253887 ago  4 12:03 Lectura_7_CruceDatos_TratamientoInformación.ipynb
-rw-rw-r-- 1 andres-campos andres-campos 159094 ago  4 12:03 Lectura_8_procesamientoDeCadenasDeTexto.ipynb
-rw-rw-r-- 1 andres-campos andres-campos  83564 ago  4 12:03 <span class=" -Color -Color-Bold -Color-Bold-Magenta">logo_python.png</span>
-rw-rw-r-- 1 andres-campos andres-campos   1533 ago  4 12:03 push_book_Github.txt
-rw-rw-r-- 1 andres-campos andres-campos    275 ago  1 12:14 README.md
-rw-rw-r-- 1 andres-campos andres-campos   5524 ago  4 12:03 references.bib
-rw-rw-r-- 1 andres-campos andres-campos     30 ago  4 12:03 requirements.txt
-rw-rw-r-- 1 andres-campos andres-campos    552 ago  4 12:03 _toc.yml
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># celda de código para probar </span>
<span class="n">urlfile</span> <span class="o">=</span> <span class="s1">&#39;datas/examen2.xlsx&#39;</span>
<span class="n">sheets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">urlfile</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sheets</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;estudiante&#39;, &#39;profesor&#39;, &#39;grupo&#39;, &#39;listado&#39;, &#39;examen&#39;, &#39;cita&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">who</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np	 pd	 sheets	 urlfile	 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sheets</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;df_&quot;</span><span class="o">+</span> <span class="n">key</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sheets</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sheets</span><span class="p">)</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sheets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df_estudiante
df_profesor
df_grupo
df_listado
df_examen
df_cita
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">info_df</span><span class="p">(</span><span class="o">*</span><span class="n">dataframes</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tamaño dataframe </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">sheets</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cabeza del dataframe:&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
      <span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_df</span><span class="p">(</span><span class="o">*</span><span class="n">sheets</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>********************************************************************************
Tamaño dataframe df_estudiante: (617, 2)
********************************************************************************
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 617 entries, 0 to 616
Data columns (total 2 columns):
 #   Column    Non-Null Count  Dtype 
---  ------    --------------  ----- 
 0   IDE       617 non-null    int64 
 1   programa  617 non-null    object
dtypes: int64(1), object(1)
memory usage: 9.8+ KB
None
********************************************************************************
Cabeza del dataframe:
    IDE                programa
0  1500     Ingeniería Mecánica
1  1501    Ingeniería Ambiental
2  1502  Ingeniería De Sistemas
3  1503    Ingeniería Ambiental
4  1504    Ingeniería Ambiental
********************************************************************************
********************************************************************************
Tamaño dataframe df_profesor: (25, 3)
********************************************************************************
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 25 entries, 0 to 24
Data columns (total 3 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   IDP         25 non-null     int64 
 1   profesor    25 non-null     object
 2   dedicacion  25 non-null     object
dtypes: int64(1), object(2)
memory usage: 728.0+ bytes
None
********************************************************************************
Cabeza del dataframe:
   IDP   profesor dedicacion
0  201   Patroclo         TC
1  202  Andrómaca    Cátedra
2  203   Artemisa         TC
3  204      Eneas    Cátedra
4  205     Néstor    Cátedra
********************************************************************************
********************************************************************************
Tamaño dataframe df_grupo: (33, 8)
********************************************************************************
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 33 entries, 0 to 32
Data columns (total 8 columns):
 #   Column    Non-Null Count  Dtype 
---  ------    --------------  ----- 
 0   IDG       33 non-null     object
 1   curso     33 non-null     object
 2   creditos  33 non-null     int64 
 3   IDP       33 non-null     int64 
 4   nestud    33 non-null     int64 
 5   periodo   33 non-null     int64 
 6   año       33 non-null     int64 
 7   jornada   33 non-null     object
dtypes: int64(5), object(3)
memory usage: 2.2+ KB
None
********************************************************************************
Cabeza del dataframe:
  IDG                      curso  creditos  IDP  nestud  periodo   año jornada
0  G1  Algoritmos y programación         3  217      23        2  2017     día
1  G2  Algoritmos y programación         3  222      23        2  2017     día
2  G3  Algoritmos y programación         3  210      21        2  2017     día
3  G4  Algoritmos y programación         3  213      22        2  2017     día
4  G5  Algoritmos y programación         3  210      21        2  2017     día
********************************************************************************
********************************************************************************
Tamaño dataframe df_listado: (617, 7)
********************************************************************************
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 617 entries, 0 to 616
Data columns (total 7 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   IDE     617 non-null    int64  
 1   IDG     617 non-null    object 
 2   corte1  617 non-null    float64
 3   corte2  617 non-null    float64
 4   prom    617 non-null    float64
 5   fallas  617 non-null    int64  
 6   fallaP  617 non-null    float64
dtypes: float64(4), int64(2), object(1)
memory usage: 33.9+ KB
None
********************************************************************************
Cabeza del dataframe:
    IDE IDG  corte1  corte2  prom  fallas  fallaP
0  1529  G1     4.0     2.0  3.00       0    0.00
1  1546  G1     3.0     0.5  1.75       2   11.76
2  1611  G1     4.0     2.0  3.00       0    0.00
3  1646  G1     4.5     3.0  3.75       0    0.00
4  1668  G1     4.0     2.5  3.25       0    0.00
********************************************************************************
********************************************************************************
Tamaño dataframe df_examen: (517, 14)
********************************************************************************
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 517 entries, 0 to 516
Data columns (total 14 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   IDE     517 non-null    int64  
 1   inicio  517 non-null    object 
 2   final   517 non-null    object 
 3   nota    517 non-null    float64
 4   p1      517 non-null    float64
 5   p2      517 non-null    float64
 6   p3      517 non-null    float64
 7   p4      517 non-null    float64
 8   p5      517 non-null    float64
 9   p6      516 non-null    float64
 10  p7      517 non-null    float64
 11  p8      517 non-null    float64
 12  p9      517 non-null    float64
 13  p10     517 non-null    float64
dtypes: float64(11), int64(1), object(2)
memory usage: 56.7+ KB
None
********************************************************************************
Cabeza del dataframe:
    IDE    inicio     final  nota   p1   p2   p3   p4   p5   p6   p7   p8  \
0  1502  18:30:00  19:09:00   2.0  0.0  0.5  0.0  0.0  0.5  NaN  0.0  0.5   
1  1503  09:05:00  10:13:00   1.0  0.0  0.0  0.0  0.5  0.0  0.0  0.0  0.0   
2  1504  09:24:00  10:04:00   1.0  0.0  0.5  0.0  0.5  0.0  0.0  0.0  0.0   
3  1505  09:09:00  09:48:00   5.0  0.5  0.5  0.5  0.5  0.5  0.5  0.5  0.5   
4  1507  18:36:00  19:00:00   0.5  0.5  0.0  0.0  0.0  0.0  0.0  0.0  0.0   

    p9  p10  
0  0.5  0.0  
1  0.0  0.5  
2  0.0  0.0  
3  0.5  0.5  
4  0.0  0.0  
********************************************************************************
********************************************************************************
Tamaño dataframe df_cita: (617, 5)
********************************************************************************
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 617 entries, 0 to 616
Data columns (total 5 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   IDE         617 non-null    int64 
 1   nsala       617 non-null    int64 
 2   sala        617 non-null    object
 3   horaExamen  617 non-null    object
 4   jornada     617 non-null    object
dtypes: int64(2), object(3)
memory usage: 24.2+ KB
None
********************************************************************************
Cabeza del dataframe:
    IDE  nsala                       sala horaExamen jornada
0  1529     18   Centro de Computo Sala 9  9:00 a.m.     día
1  1546      6  Centro de Computo Sala 10  9:00 a.m.     día
2  1611     17   Centro de Computo Sala 8  9:00 a.m.     día
3  1646     15   Centro de Computo Sala 6  9:00 a.m.     día
4  1668     14   Centro de Computo Sala 5  9:00 a.m.     día
********************************************************************************
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cita</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>nsala</th>
      <th>sala</th>
      <th>horaExamen</th>
      <th>jornada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1529</td>
      <td>18</td>
      <td>Centro de Computo Sala 9</td>
      <td>9:00 a.m.</td>
      <td>día</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1546</td>
      <td>6</td>
      <td>Centro de Computo Sala 10</td>
      <td>9:00 a.m.</td>
      <td>día</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_estudiante</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>programa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1500</td>
      <td>Ingeniería Mecánica</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1501</td>
      <td>Ingeniería Ambiental</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_estudiante</span><span class="p">[</span><span class="s1">&#39;IDE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1500    1
1914    1
1907    1
1908    1
1909    1
       ..
1707    1
1708    1
1709    1
1710    1
2116    1
Name: IDE, Length: 617, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_examen</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>inicio</th>
      <th>final</th>
      <th>nota</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
      <th>p5</th>
      <th>p6</th>
      <th>p7</th>
      <th>p8</th>
      <th>p9</th>
      <th>p10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1502</td>
      <td>18:30:00</td>
      <td>19:09:00</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1503</td>
      <td>09:05:00</td>
      <td>10:13:00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_profesor</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDP</th>
      <th>profesor</th>
      <th>dedicacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201</td>
      <td>Patroclo</td>
      <td>TC</td>
    </tr>
    <tr>
      <th>1</th>
      <td>202</td>
      <td>Andrómaca</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>2</th>
      <td>203</td>
      <td>Artemisa</td>
      <td>TC</td>
    </tr>
    <tr>
      <th>3</th>
      <td>204</td>
      <td>Eneas</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>4</th>
      <td>205</td>
      <td>Néstor</td>
      <td>Cátedra</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_grupo</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDG</th>
      <th>curso</th>
      <th>creditos</th>
      <th>IDP</th>
      <th>nestud</th>
      <th>periodo</th>
      <th>año</th>
      <th>jornada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>G1</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>217</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
    </tr>
    <tr>
      <th>1</th>
      <td>G2</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>222</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_listado</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>IDG</th>
      <th>corte1</th>
      <th>corte2</th>
      <th>prom</th>
      <th>fallas</th>
      <th>fallaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1529</td>
      <td>G1</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>3.00</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1546</td>
      <td>G1</td>
      <td>3.0</td>
      <td>0.5</td>
      <td>1.75</td>
      <td>2</td>
      <td>11.76</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="actividad-2-preguntas-que-se-pueden-responder-con-estos-datos">
<h3>Actividad 2. Preguntas que se pueden responder con estos datos<a class="headerlink" href="#actividad-2-preguntas-que-se-pueden-responder-con-estos-datos" title="Permalink to this headline">#</a></h3>
<p>Una vez se tiene un completo entendimiento de la información, y se conoce el procedimiento para cargar la información, se procede a abordar ciertas preguntas de intereś que surgen de los datos y se procede a analizar la posible solución. Seguramente, la solución a las siguientes preguntas requiere un cruce de información, un filtrado de los datos, un agrupamiento y quizá un ordenamiento de los datos resultantes.</p>
<ol class="simple">
<li><p>Cuáles son los profesores asignados a cada grupo, ordenado por profesor?</p></li>
<li><p>Cuáles son los estudiantes que tiene cada profesor por grupo y por programa académico?</p></li>
<li><p>Cuáles son los promedios de calificación en el primer y segundo corte que tienen cada uno de los profesores en los grupos de Ingeniería de Sistemas?</p></li>
<li><p>Qué estudiantes de cada programa han dejado de presentar el examen?</p></li>
<li><p>Cuáles de los estudiantes, que presentaron el examen, no aparecen en el listado?</p></li>
</ol>
<section id="solucion-pregunta-1">
<h4><strong>Solución pregunta 1</strong><a class="headerlink" href="#solucion-pregunta-1" title="Permalink to this headline">#</a></h4>
<p><em>Cuáles son los profesores asignados a cada grupo, ordenado por profesor?</em></p>
<p>Para esto se deben relacionar las tablas de grupo y profesor. En este caso, no es casualidad que ambas tablas tienen una misma columna llamada <strong>IDP</strong> y que además corresponden a el identificador del profesor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_profesor</span><span class="p">[</span><span class="s2">&quot;IDP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>201    1
214    1
224    1
223    1
222    1
221    1
220    1
219    1
218    1
217    1
216    1
215    1
213    1
202    1
212    1
211    1
210    1
209    1
208    1
207    1
206    1
205    1
204    1
203    1
225    1
Name: IDP, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imprimimos nombres de las columna de los dataframes.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_grupo</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_profesor</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;IDG&#39; &#39;curso&#39; &#39;creditos&#39; &#39;IDP&#39; &#39;nestud&#39; &#39;periodo&#39; &#39;año&#39; &#39;jornada&#39;]
[&#39;IDP&#39; &#39;profesor&#39; &#39;dedicacion&#39;]
</pre></div>
</div>
</div>
</div>
<p>Para combinar las fuentes de información el dataframe (que se utiliza como tabla izquierda) hace un llamado de la función <em>merge</em>, a la cual se le pasa el dataframe que funcionará como tabla derecha de la unión. Los parámetros importantes de la función <em>merge</em> son los siguientes:</p>
<ul class="simple">
<li><p><em>right:</em> (requerido) dataframe que funciona como tabla derecha.</p></li>
<li><p><em>how:</em> (opcional) indica el tipo de unión: {‘left’, ‘right’, ‘outer’, ‘inner’} si no se especifíca el valor por omisión es ‘inner’</p></li>
<li><p><em>on:</em> (opcional) especifica la columna por la que se hace la unión. Esta debe encontrarse en ambos dataframes. Si no se especifica la función busca la primera coincidencia en nombre y tipo de columna.</p></li>
<li><p><em>left_on:</em> (opcional) columna o nombres de columna para hacer la unión con el dataframe de la izquierda</p></li>
<li><p><em>right_on:</em> (opcional) columna o nombres de columna para hacer la unión con el dataframe de la derecha</p></li>
</ul>
</section>
<section id="resolver-pregunta-1">
<h4>Resolver Pregunta 1.<a class="headerlink" href="#resolver-pregunta-1" title="Permalink to this headline">#</a></h4>
<p><em>Cuáles son los profesores asignados a cada grupo, ordenado por profesor?</em></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. combinar &#39;df_profesor&#39; y &#39;df_grupo&#39;</span>
<span class="n">dfgp</span> <span class="o">=</span> <span class="n">df_grupo</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_profesor</span><span class="p">)</span>
<span class="n">dfgp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dfgp</span><span class="p">[[</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span> <span class="s1">&#39;IDG&#39;</span><span class="p">,</span> <span class="s1">&#39;curso&#39;</span><span class="p">,</span> <span class="s1">&#39;nestud&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. combinar &#39;df_profesor&#39; y &#39;df_grupo&#39;</span>
<span class="n">dfgp</span> <span class="o">=</span> <span class="n">df_grupo</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_profesor</span><span class="p">)</span>
<span class="n">dfgp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dfgp</span><span class="p">[[</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span> <span class="s1">&#39;IDG&#39;</span><span class="p">,</span> <span class="s1">&#39;curso&#39;</span><span class="p">,</span> <span class="s1">&#39;nestud&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>profesor</th>
      <th>IDG</th>
      <th>curso</th>
      <th>nestud</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Agamenón</td>
      <td>G5</td>
      <td>Algoritmos y programación</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Agamenón</td>
      <td>G3</td>
      <td>Algoritmos y programación</td>
      <td>21</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Agenor</td>
      <td>G31</td>
      <td>Algoritmos y programación</td>
      <td>23</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Andrómaca</td>
      <td>G19</td>
      <td>Algoritmos y programación</td>
      <td>19</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Apolo</td>
      <td>G1</td>
      <td>Algoritmos y programación</td>
      <td>23</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Aquiles</td>
      <td>G15</td>
      <td>Algoritmos y programación</td>
      <td>22</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Artemisa</td>
      <td>G7</td>
      <td>Algoritmos y programación</td>
      <td>20</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Artemisa</td>
      <td>G10</td>
      <td>Algoritmos y programación</td>
      <td>20</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Artemisa</td>
      <td>G14</td>
      <td>Algoritmos y programación</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atenea</td>
      <td>G2</td>
      <td>Algoritmos y programación</td>
      <td>23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Atenea</td>
      <td>G6</td>
      <td>Algoritmos y programación</td>
      <td>22</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Briseida</td>
      <td>G25</td>
      <td>Algoritmos y programación</td>
      <td>17</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Diomedes</td>
      <td>G13</td>
      <td>Algoritmos y programación</td>
      <td>19</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Dolón</td>
      <td>G12</td>
      <td>Algoritmos y programación</td>
      <td>21</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Eneas</td>
      <td>G20</td>
      <td>Algoritmos y programación</td>
      <td>8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Euforbo</td>
      <td>G8</td>
      <td>Algoritmos y programación</td>
      <td>23</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Hades</td>
      <td>G9</td>
      <td>Algoritmos y programación</td>
      <td>24</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hefesto</td>
      <td>G33</td>
      <td>Algoritmos y programación</td>
      <td>21</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hefesto</td>
      <td>G4</td>
      <td>Algoritmos y programación</td>
      <td>22</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Hermes</td>
      <td>G30</td>
      <td>Algoritmos y programación</td>
      <td>13</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Hermes</td>
      <td>G17</td>
      <td>Algoritmos y programación</td>
      <td>11</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Héctor</td>
      <td>G27</td>
      <td>Algoritmos y programación</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Menelao</td>
      <td>G16</td>
      <td>Algoritmos y programación</td>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Menelao</td>
      <td>G24</td>
      <td>Algoritmos y programación</td>
      <td>15</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Menelao</td>
      <td>G21</td>
      <td>Algoritmos y programación</td>
      <td>17</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Néstor</td>
      <td>G28</td>
      <td>Algoritmos y programación</td>
      <td>20</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Odiseo</td>
      <td>G23</td>
      <td>Algoritmos y programación</td>
      <td>18</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Paris</td>
      <td>G29</td>
      <td>Algoritmos y programación</td>
      <td>12</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Patroclo</td>
      <td>G11</td>
      <td>Algoritmos y programación</td>
      <td>23</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Polidoro</td>
      <td>G32</td>
      <td>Algoritmos y programación</td>
      <td>24</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Poseidón</td>
      <td>G22</td>
      <td>Algoritmos y programación</td>
      <td>12</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Príamo</td>
      <td>G26</td>
      <td>Algoritmos y programación</td>
      <td>15</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Pándarp</td>
      <td>G18</td>
      <td>Algoritmos y programación</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_grupo</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDG</th>
      <th>curso</th>
      <th>creditos</th>
      <th>IDP</th>
      <th>nestud</th>
      <th>periodo</th>
      <th>año</th>
      <th>jornada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>G1</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>217</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
    </tr>
    <tr>
      <th>1</th>
      <td>G2</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>222</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_profesor</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDP</th>
      <th>profesor</th>
      <th>dedicacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201</td>
      <td>Patroclo</td>
      <td>TC</td>
    </tr>
    <tr>
      <th>1</th>
      <td>202</td>
      <td>Andrómaca</td>
      <td>Cátedra</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. combinar &#39;df_profesor&#39; y &#39;df_grupo&#39;</span>
<span class="n">dfgp</span> <span class="o">=</span> <span class="n">df_grupo</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_profesor</span><span class="p">)</span>
<span class="n">dfgp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDG</th>
      <th>curso</th>
      <th>creditos</th>
      <th>IDP</th>
      <th>nestud</th>
      <th>periodo</th>
      <th>año</th>
      <th>jornada</th>
      <th>profesor</th>
      <th>dedicacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>G1</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>217</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Apolo</td>
      <td>MT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>G2</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>222</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Atenea</td>
      <td>TC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>G6</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>222</td>
      <td>22</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Atenea</td>
      <td>TC</td>
    </tr>
    <tr>
      <th>3</th>
      <td>G3</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>4</th>
      <td>G5</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfgp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfgp</span><span class="p">[[</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span> <span class="s1">&#39;profesor&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDG</th>
      <th>profesor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>G5</td>
      <td>Agamenón</td>
    </tr>
    <tr>
      <th>3</th>
      <td>G3</td>
      <td>Agamenón</td>
    </tr>
    <tr>
      <th>31</th>
      <td>G31</td>
      <td>Agenor</td>
    </tr>
    <tr>
      <th>22</th>
      <td>G19</td>
      <td>Andrómaca</td>
    </tr>
    <tr>
      <th>0</th>
      <td>G1</td>
      <td>Apolo</td>
    </tr>
    <tr>
      <th>15</th>
      <td>G15</td>
      <td>Aquiles</td>
    </tr>
    <tr>
      <th>7</th>
      <td>G7</td>
      <td>Artemisa</td>
    </tr>
    <tr>
      <th>8</th>
      <td>G10</td>
      <td>Artemisa</td>
    </tr>
    <tr>
      <th>9</th>
      <td>G14</td>
      <td>Artemisa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>G2</td>
      <td>Atenea</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="solucion-pregunta-2">
<h4><strong>Solución pregunta 2</strong><a class="headerlink" href="#solucion-pregunta-2" title="Permalink to this headline">#</a></h4>
<p><em>Cuáles son los estudiantes que tiene cada profesor por grupo y por programa académico?</em></p>
<p>En esta caso podemos cruzar la tabla anterior con <code class="docutils literal notranslate"><span class="pre">df_estudiante</span></code>, pues son las tablas que tienen la información solicitada, pero debemos hacer uso de otra tabla para lograr hacer el puente y enlazar la información.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfgp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDG</th>
      <th>curso</th>
      <th>creditos</th>
      <th>IDP</th>
      <th>nestud</th>
      <th>periodo</th>
      <th>año</th>
      <th>jornada</th>
      <th>profesor</th>
      <th>dedicacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>G5</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>3</th>
      <td>G3</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>31</th>
      <td>G31</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>221</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agenor</td>
      <td>TC</td>
    </tr>
    <tr>
      <th>22</th>
      <td>G19</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>202</td>
      <td>19</td>
      <td>2</td>
      <td>2017</td>
      <td>noche</td>
      <td>Andrómaca</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>0</th>
      <td>G1</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>217</td>
      <td>23</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Apolo</td>
      <td>MT</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfel</span> <span class="o">=</span> <span class="n">df_estudiante</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_listado</span><span class="p">)</span> <span class="c1"># Puente</span>
<span class="n">dfel</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>programa</th>
      <th>IDG</th>
      <th>corte1</th>
      <th>corte2</th>
      <th>prom</th>
      <th>fallas</th>
      <th>fallaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1500</td>
      <td>Ingeniería Mecánica</td>
      <td>G5</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1501</td>
      <td>Ingeniería Ambiental</td>
      <td>G12</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>12</td>
      <td>70.59</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1502</td>
      <td>Ingeniería De Sistemas</td>
      <td>G16</td>
      <td>2.5</td>
      <td>3.5</td>
      <td>3.00</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1503</td>
      <td>Ingeniería Ambiental</td>
      <td>G4</td>
      <td>4.5</td>
      <td>3.0</td>
      <td>3.75</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1504</td>
      <td>Ingeniería Ambiental</td>
      <td>G6</td>
      <td>3.5</td>
      <td>2.5</td>
      <td>3.00</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfge</span> <span class="o">=</span> <span class="n">dfel</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfgp</span><span class="p">)</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>programa</th>
      <th>IDG</th>
      <th>corte1</th>
      <th>corte2</th>
      <th>prom</th>
      <th>fallas</th>
      <th>fallaP</th>
      <th>curso</th>
      <th>creditos</th>
      <th>IDP</th>
      <th>nestud</th>
      <th>periodo</th>
      <th>año</th>
      <th>jornada</th>
      <th>profesor</th>
      <th>dedicacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1500</td>
      <td>Ingeniería Mecánica</td>
      <td>G5</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0</td>
      <td>0.0</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1620</td>
      <td>Ingeniería Ambiental</td>
      <td>G5</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.50</td>
      <td>0</td>
      <td>0.0</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1675</td>
      <td>Ingeniería De Sistemas</td>
      <td>G5</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.50</td>
      <td>0</td>
      <td>0.0</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1702</td>
      <td>Ingeniería Ambiental</td>
      <td>G5</td>
      <td>4.0</td>
      <td>3.5</td>
      <td>3.75</td>
      <td>0</td>
      <td>0.0</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1706</td>
      <td>Ingeniería De Sistemas</td>
      <td>G5</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.50</td>
      <td>0</td>
      <td>0.0</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## A continuación una posible solución:</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span><span class="s1">&#39;programa&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">dfge</span><span class="p">[[</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span><span class="s1">&#39;programa&#39;</span><span class="p">,</span><span class="s1">&#39;IDE&#39;</span><span class="p">]]</span>
<span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>profesor</th>
      <th>IDG</th>
      <th>programa</th>
      <th>IDE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>491</th>
      <td>Agamenón</td>
      <td>G3</td>
      <td>Ingeniería Ambiental</td>
      <td>1547</td>
    </tr>
    <tr>
      <th>495</th>
      <td>Agamenón</td>
      <td>G3</td>
      <td>Ingeniería Ambiental</td>
      <td>1648</td>
    </tr>
    <tr>
      <th>497</th>
      <td>Agamenón</td>
      <td>G3</td>
      <td>Ingeniería Ambiental</td>
      <td>1686</td>
    </tr>
    <tr>
      <th>499</th>
      <td>Agamenón</td>
      <td>G3</td>
      <td>Ingeniería Ambiental</td>
      <td>1741</td>
    </tr>
    <tr>
      <th>500</th>
      <td>Agamenón</td>
      <td>G3</td>
      <td>Ingeniería Ambiental</td>
      <td>1785</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="solucion-pregunta-3">
<h3><em><strong>Solución pregunta 3</strong></em><a class="headerlink" href="#solucion-pregunta-3" title="Permalink to this headline">#</a></h3>
<p><em>Cuáles son los promedios de calificación en el primer y segundo corte que tienen cada uno de los profesores en los grupos de Ingeniería de Sistemas?</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_listado</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">mask</span>  <span class="o">=</span> <span class="n">df_temp</span><span class="p">[</span><span class="s2">&quot;programa&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ingeniería De Sistemas&quot;</span>
<span class="n">mask1</span> <span class="o">=</span> <span class="n">df_temp</span><span class="p">[</span><span class="s2">&quot;profesor&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Apolo&quot;</span>
<span class="n">df_temp</span><span class="p">[</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">mask1</span><span class="p">][[</span><span class="s2">&quot;corte1&quot;</span><span class="p">,</span><span class="s2">&quot;corte2&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>corte1    3.586957
corte2    2.043478
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="agrupar-datos-con-el-metodo-groupby">
<h2>Agrupar datos con el método <em>groupby</em><a class="headerlink" href="#agrupar-datos-con-el-metodo-groupby" title="Permalink to this headline">#</a></h2>
<p>En el Análisis de la información se suelen usar funciones de resumen, las cuales plantean el agrupamiento de ciertas características por categorías. Para una revisón de la función <em>groupby</em> con ejemplos prácticos visite la página: <a class="reference external" href="https://www.tutorialspoint.com/python_pandas/python_pandas_groupby.htm">tutorialspoint</a></p>
<section id="resumen-de-funciones-para-trabajar-con-series-numericas-en-pandas">
<h3><strong>Resumen de funciones para trabajar con series numéricas en pandas:</strong><a class="headerlink" href="#resumen-de-funciones-para-trabajar-con-series-numericas-en-pandas" title="Permalink to this headline">#</a></h3>
<p>Lista de funciones de pandas y numpy para usar con variables numéricas en dataframes:</p>
<p><code class="docutils literal notranslate"><span class="pre">count,</span> <span class="pre">sum,</span> <span class="pre">mean,</span> <span class="pre">mad,</span> <span class="pre">median,</span> <span class="pre">min,</span> <span class="pre">max,</span> <span class="pre">mode,</span> <span class="pre">abs,</span> <span class="pre">prod,</span> <span class="pre">std,</span> <span class="pre">var,</span> <span class="pre">skew,</span> <span class="pre">kurt,</span> <span class="pre">quantile,</span> <span class="pre">cumsum,</span> <span class="pre">sumprod,</span> <span class="pre">cummax,</span> <span class="pre">cummin</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Ejemplo 1</span>
<span class="n">ipl_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Team&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Riders&#39;</span><span class="p">,</span> <span class="s1">&#39;Riders&#39;</span><span class="p">,</span> <span class="s1">&#39;Devils&#39;</span><span class="p">,</span> <span class="s1">&#39;Devils&#39;</span><span class="p">,</span> <span class="s1">&#39;Kings&#39;</span><span class="p">,</span>
   <span class="s1">&#39;kings&#39;</span><span class="p">,</span> <span class="s1">&#39;Kings&#39;</span><span class="p">,</span> <span class="s1">&#39;Kings&#39;</span><span class="p">,</span> <span class="s1">&#39;Riders&#39;</span><span class="p">,</span> <span class="s1">&#39;Royals&#39;</span><span class="p">,</span> <span class="s1">&#39;Royals&#39;</span><span class="p">,</span> <span class="s1">&#39;Riders&#39;</span><span class="p">],</span>
   <span class="s1">&#39;Rank&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
   <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2014</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2014</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2014</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2016</span><span class="p">,</span><span class="mi">2017</span><span class="p">,</span><span class="mi">2016</span><span class="p">,</span><span class="mi">2014</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2017</span><span class="p">],</span>
   <span class="s1">&#39;Points&#39;</span><span class="p">:[</span><span class="mi">876</span><span class="p">,</span><span class="mi">789</span><span class="p">,</span><span class="mi">863</span><span class="p">,</span><span class="mi">673</span><span class="p">,</span><span class="mi">741</span><span class="p">,</span><span class="mi">812</span><span class="p">,</span><span class="mi">756</span><span class="p">,</span><span class="mi">788</span><span class="p">,</span><span class="mi">694</span><span class="p">,</span><span class="mi">701</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="mi">690</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ipl_data</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>Rank</th>
      <th>Year</th>
      <th>Points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Riders</td>
      <td>1</td>
      <td>2014</td>
      <td>876</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Riders</td>
      <td>2</td>
      <td>2015</td>
      <td>789</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Devils</td>
      <td>2</td>
      <td>2014</td>
      <td>863</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Devils</td>
      <td>3</td>
      <td>2015</td>
      <td>673</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kings</td>
      <td>3</td>
      <td>2014</td>
      <td>741</td>
    </tr>
    <tr>
      <th>5</th>
      <td>kings</td>
      <td>4</td>
      <td>2015</td>
      <td>812</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Kings</td>
      <td>1</td>
      <td>2016</td>
      <td>756</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Kings</td>
      <td>1</td>
      <td>2017</td>
      <td>788</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Riders</td>
      <td>2</td>
      <td>2016</td>
      <td>694</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Royals</td>
      <td>4</td>
      <td>2014</td>
      <td>701</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Royals</td>
      <td>1</td>
      <td>2015</td>
      <td>804</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Riders</td>
      <td>2</td>
      <td>2017</td>
      <td>690</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Obtenemos los grupos y los índices de los registros de cada grupo.</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Devils&#39;: [2, 3], &#39;Kings&#39;: [4, 6, 7], &#39;Riders&#39;: [0, 1, 8, 11], &#39;Royals&#39;: [9, 10], &#39;kings&#39;: [5]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Obtenemos los grupos y los índices de los registros de cada grupo.</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">groups</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;Devils&#39;, 2014): [2], (&#39;Devils&#39;, 2015): [3], (&#39;Kings&#39;, 2014): [4], (&#39;Kings&#39;, 2016): [6], (&#39;Kings&#39;, 2017): [7], (&#39;Riders&#39;, 2014): [0], (&#39;Riders&#39;, 2015): [1], (&#39;Riders&#39;, 2016): [8], (&#39;Riders&#39;, 2017): [11], (&#39;Royals&#39;, 2014): [9], (&#39;Royals&#39;, 2015): [10], (&#39;kings&#39;, 2015): [5]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">indices</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;Devils&#39;, 2014): array([2]),
 (&#39;Devils&#39;, 2015): array([3]),
 (&#39;Kings&#39;, 2014): array([4]),
 (&#39;Kings&#39;, 2016): array([6]),
 (&#39;Kings&#39;, 2017): array([7]),
 (&#39;Riders&#39;, 2014): array([0]),
 (&#39;Riders&#39;, 2015): array([1]),
 (&#39;Riders&#39;, 2016): array([8]),
 (&#39;Riders&#39;, 2017): array([11]),
 (&#39;Royals&#39;, 2014): array([9]),
 (&#39;Royals&#39;, 2015): array([10]),
 (&#39;kings&#39;, 2015): array([5])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Dataframe con los grupo generados.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2014
     Team  Rank  Year  Points
0  Riders     1  2014     876
2  Devils     2  2014     863
4   Kings     3  2014     741
9  Royals     4  2014     701
2015
      Team  Rank  Year  Points
1   Riders     2  2015     789
3   Devils     3  2015     673
5    kings     4  2015     812
10  Royals     1  2015     804
2016
     Team  Rank  Year  Points
6   Kings     1  2016     756
8  Riders     2  2016     694
2017
      Team  Rank  Year  Points
7    Kings     1  2017     788
11  Riders     2  2017     690
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Dataframe con un grupo particular.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="mi">2014</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>Rank</th>
      <th>Year</th>
      <th>Points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Riders</td>
      <td>1</td>
      <td>2014</td>
      <td>876</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Devils</td>
      <td>2</td>
      <td>2014</td>
      <td>863</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kings</td>
      <td>3</td>
      <td>2014</td>
      <td>741</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Royals</td>
      <td>4</td>
      <td>2014</td>
      <td>701</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Cantidad de registros en cada grupo</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Team
Devils    2
Kings     3
Riders    4
Royals    2
kings     1
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>Rank</th>
      <th>Year</th>
      <th>Points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Riders</td>
      <td>1</td>
      <td>2014</td>
      <td>876</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Riders</td>
      <td>2</td>
      <td>2015</td>
      <td>789</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Devils</td>
      <td>2</td>
      <td>2014</td>
      <td>863</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Devils</td>
      <td>3</td>
      <td>2015</td>
      <td>673</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kings</td>
      <td>3</td>
      <td>2014</td>
      <td>741</td>
    </tr>
    <tr>
      <th>5</th>
      <td>kings</td>
      <td>4</td>
      <td>2015</td>
      <td>812</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Kings</td>
      <td>1</td>
      <td>2016</td>
      <td>756</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Kings</td>
      <td>1</td>
      <td>2017</td>
      <td>788</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Riders</td>
      <td>2</td>
      <td>2016</td>
      <td>694</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Royals</td>
      <td>4</td>
      <td>2014</td>
      <td>701</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Royals</td>
      <td>1</td>
      <td>2015</td>
      <td>804</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Riders</td>
      <td>2</td>
      <td>2017</td>
      <td>690</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Función de agregación</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year
2014    795.25
2015    769.50
2016    725.00
2017    739.00
Name: Points, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Varias funciones de agregación para una columna luego de ser agrupados.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span>
<span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Devils</th>
      <td>1536</td>
      <td>768.000000</td>
      <td>134.350288</td>
    </tr>
    <tr>
      <th>Kings</th>
      <td>2285</td>
      <td>761.666667</td>
      <td>24.006943</td>
    </tr>
    <tr>
      <th>Riders</th>
      <td>3049</td>
      <td>762.250000</td>
      <td>88.567771</td>
    </tr>
    <tr>
      <th>Royals</th>
      <td>1505</td>
      <td>752.500000</td>
      <td>72.831998</td>
    </tr>
    <tr>
      <th>kings</th>
      <td>812</td>
      <td>812.000000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Transformación de datos por grupos.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rank</th>
      <th>Year</th>
      <th>Points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-15.000000</td>
      <td>-11.618950</td>
      <td>12.843272</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.000000</td>
      <td>-3.872983</td>
      <td>3.020286</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-7.071068</td>
      <td>-7.071068</td>
      <td>7.071068</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.071068</td>
      <td>7.071068</td>
      <td>-7.071068</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.547005</td>
      <td>-10.910895</td>
      <td>-8.608621</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-5.773503</td>
      <td>2.182179</td>
      <td>-2.360428</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-5.773503</td>
      <td>8.728716</td>
      <td>10.969049</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5.000000</td>
      <td>3.872983</td>
      <td>-7.705963</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7.071068</td>
      <td>-7.071068</td>
      <td>-7.071068</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-7.071068</td>
      <td>7.071068</td>
      <td>7.071068</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5.000000</td>
      <td>11.618950</td>
      <td>-8.157595</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Aquellos grupos con 3 o más registros</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>Rank</th>
      <th>Year</th>
      <th>Points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Riders</td>
      <td>1</td>
      <td>2014</td>
      <td>876</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Riders</td>
      <td>2</td>
      <td>2015</td>
      <td>789</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kings</td>
      <td>3</td>
      <td>2014</td>
      <td>741</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Kings</td>
      <td>1</td>
      <td>2016</td>
      <td>756</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Kings</td>
      <td>1</td>
      <td>2017</td>
      <td>788</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Riders</td>
      <td>2</td>
      <td>2016</td>
      <td>694</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Riders</td>
      <td>2</td>
      <td>2017</td>
      <td>690</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="ejemplos-de-groupby-con-examen2-xlsx">
<h3>Ejemplos de groupby con <em>examen2.xlsx</em><a class="headerlink" href="#ejemplos-de-groupby-con-examen2-xlsx" title="Permalink to this headline">#</a></h3>
<p>Pruebe los siguientes ejemplos y analice el resultado:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ejemplos con groupby</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span><span class="s1">&#39;programa&#39;</span><span class="p">])[[</span><span class="s1">&#39;IDE&#39;</span><span class="p">,</span><span class="s1">&#39;corte1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">})</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span><span class="s1">&#39;programa&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;corte1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">],</span> <span class="s1">&#39;corte2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">]})</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span><span class="s1">&#39;programa&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;corte1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mad&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]})</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;programa&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="s1">&#39;last&#39;</span><span class="p">,</span><span class="s1">&#39;nunique&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">])[</span><span class="s1">&#39;programa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfge</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>programa</th>
      <th>IDG</th>
      <th>corte1</th>
      <th>corte2</th>
      <th>prom</th>
      <th>fallas</th>
      <th>fallaP</th>
      <th>curso</th>
      <th>creditos</th>
      <th>IDP</th>
      <th>nestud</th>
      <th>periodo</th>
      <th>año</th>
      <th>jornada</th>
      <th>profesor</th>
      <th>dedicacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>491</th>
      <td>1547</td>
      <td>Ingeniería Ambiental</td>
      <td>G3</td>
      <td>4.5</td>
      <td>4.5</td>
      <td>4.50</td>
      <td>0</td>
      <td>0.0</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
    <tr>
      <th>495</th>
      <td>1648</td>
      <td>Ingeniería Ambiental</td>
      <td>G3</td>
      <td>4.5</td>
      <td>4.0</td>
      <td>4.25</td>
      <td>0</td>
      <td>0.0</td>
      <td>Algoritmos y programación</td>
      <td>3</td>
      <td>210</td>
      <td>21</td>
      <td>2</td>
      <td>2017</td>
      <td>día</td>
      <td>Agamenón</td>
      <td>Cátedra</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfge</span><span class="p">[</span><span class="s2">&quot;IDE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">## Todos los estudiantes son distintos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1547    1
2099    1
1983    1
2102    1
2112    1
       ..
1987    1
2002    1
2048    1
2050    1
1866    1
Name: IDE, Length: 617, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ¿Cuánto estudiantes tiene cada profesor?</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;profesor&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>profesor
Artemisa     62
Menelao      49
Atenea       45
Hefesto      43
Agamenón     42
Polidoro     24
Hermes       24
Hades        24
Apolo        23
Euforbo      23
Agenor       23
Patroclo     23
Aquiles      22
Dolón        21
Néstor       20
Andrómaca    19
Diomedes     19
Odiseo       18
Briseida     17
Héctor       16
Príamo       15
Pándarp      13
Paris        12
Poseidón     12
Eneas         8
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Obtenemos para cada columna seleccionada y para cada agrupación size = Tamaño, mean = media muestral y std = desviación estandar.</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span><span class="s1">&#39;programa&#39;</span><span class="p">])[[</span><span class="s1">&#39;corte1&#39;</span><span class="p">,</span><span class="s1">&#39;corte2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">corte1</th>
      <th colspan="3" halign="left">corte2</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>size</th>
      <th>mean</th>
      <th>std</th>
      <th>size</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>profesor</th>
      <th>IDG</th>
      <th>programa</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Agamenón</th>
      <th rowspan="4" valign="top">G3</th>
      <th>Ingeniería Ambiental</th>
      <td>13</td>
      <td>4.192308</td>
      <td>0.325222</td>
      <td>13</td>
      <td>2.923077</td>
      <td>0.996790</td>
    </tr>
    <tr>
      <th>Ingeniería De Sistemas</th>
      <td>1</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>1</td>
      <td>1.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ingeniería Industrial</th>
      <td>4</td>
      <td>4.250000</td>
      <td>0.288675</td>
      <td>4</td>
      <td>3.500000</td>
      <td>1.080123</td>
    </tr>
    <tr>
      <th>Ingeniería Mecánica</th>
      <td>3</td>
      <td>4.333333</td>
      <td>0.288675</td>
      <td>3</td>
      <td>3.166667</td>
      <td>1.154701</td>
    </tr>
    <tr>
      <th>G5</th>
      <th>Ingeniería Ambiental</th>
      <td>8</td>
      <td>3.875000</td>
      <td>0.790569</td>
      <td>8</td>
      <td>2.812500</td>
      <td>0.752970</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Pándarp</th>
      <th rowspan="5" valign="top">G18</th>
      <th>Ingeniería Ambiental</th>
      <td>2</td>
      <td>3.500000</td>
      <td>0.707107</td>
      <td>2</td>
      <td>3.750000</td>
      <td>1.060660</td>
    </tr>
    <tr>
      <th>Ingeniería De Sistemas</th>
      <td>2</td>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>2</td>
      <td>4.500000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>Ingeniería Electrónica</th>
      <td>4</td>
      <td>3.250000</td>
      <td>1.322876</td>
      <td>4</td>
      <td>2.250000</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <th>Ingeniería Industrial</th>
      <td>3</td>
      <td>4.166667</td>
      <td>0.288675</td>
      <td>3</td>
      <td>3.833333</td>
      <td>1.154701</td>
    </tr>
    <tr>
      <th>Ingeniería Mecánica</th>
      <td>2</td>
      <td>1.000000</td>
      <td>1.414214</td>
      <td>2</td>
      <td>1.250000</td>
      <td>1.767767</td>
    </tr>
  </tbody>
</table>
<p>131 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Información de los grupos para la variable seleccionada y las distintas funciones de agragación.</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;programa&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="s1">&#39;last&#39;</span><span class="p">,</span><span class="s1">&#39;nunique&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="5" halign="left">programa</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>count</th>
      <th>first</th>
      <th>last</th>
      <th>nunique</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>profesor</th>
      <th>IDG</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Agamenón</th>
      <th>G3</th>
      <td>21</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>4</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>G5</th>
      <td>21</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Agenor</th>
      <th>G31</th>
      <td>23</td>
      <td>Ingeniería De Sistemas</td>
      <td>Ingeniería De Sistemas</td>
      <td>1</td>
      <td>Ingeniería De SistemasIngeniería De SistemasIn...</td>
    </tr>
    <tr>
      <th>Andrómaca</th>
      <th>G19</th>
      <td>19</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Apolo</th>
      <th>G1</th>
      <td>23</td>
      <td>Ingeniería De Sistemas</td>
      <td>Ingeniería De Sistemas</td>
      <td>1</td>
      <td>Ingeniería De SistemasIngeniería De SistemasIn...</td>
    </tr>
    <tr>
      <th>Aquiles</th>
      <th>G15</th>
      <td>22</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>4</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Artemisa</th>
      <th>G10</th>
      <td>20</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Industrial</td>
      <td>3</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>G14</th>
      <td>22</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>G7</th>
      <td>20</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Atenea</th>
      <th>G2</th>
      <td>23</td>
      <td>Ingeniería De Sistemas</td>
      <td>Ingeniería De Sistemas</td>
      <td>1</td>
      <td>Ingeniería De SistemasIngeniería De SistemasIn...</td>
    </tr>
    <tr>
      <th>G6</th>
      <td>22</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Briseida</th>
      <th>G25</th>
      <td>17</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Industrial</td>
      <td>3</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Diomedes</th>
      <th>G13</th>
      <td>19</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Dolón</th>
      <th>G12</th>
      <td>21</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Eneas</th>
      <th>G20</th>
      <td>8</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería De SistemasInge...</td>
    </tr>
    <tr>
      <th>Euforbo</th>
      <th>G8</th>
      <td>23</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Hades</th>
      <th>G9</th>
      <td>24</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Hefesto</th>
      <th>G33</th>
      <td>21</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>3</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>G4</th>
      <td>22</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Hermes</th>
      <th>G17</th>
      <td>11</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>3</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>G30</th>
      <td>13</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>4</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Héctor</th>
      <th>G27</th>
      <td>16</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Menelao</th>
      <th>G16</th>
      <td>17</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería De Sistemas</td>
      <td>2</td>
      <td>Ingeniería AmbientalIngeniería De SistemasInge...</td>
    </tr>
    <tr>
      <th>G21</th>
      <td>17</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>G24</th>
      <td>15</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería De SistemasInge...</td>
    </tr>
    <tr>
      <th>Néstor</th>
      <th>G28</th>
      <td>20</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>4</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Odiseo</th>
      <th>G23</th>
      <td>18</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>4</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Paris</th>
      <th>G29</th>
      <td>12</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Industrial</td>
      <td>3</td>
      <td>Ingeniería AmbientalIngeniería De SistemasInge...</td>
    </tr>
    <tr>
      <th>Patroclo</th>
      <th>G11</th>
      <td>23</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Industrial</td>
      <td>4</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Polidoro</th>
      <th>G32</th>
      <td>24</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Electrónica</td>
      <td>3</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Poseidón</th>
      <th>G22</th>
      <td>12</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>4</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Príamo</th>
      <th>G26</th>
      <td>15</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
    <tr>
      <th>Pándarp</th>
      <th>G18</th>
      <td>13</td>
      <td>Ingeniería Ambiental</td>
      <td>Ingeniería Mecánica</td>
      <td>5</td>
      <td>Ingeniería AmbientalIngeniería AmbientalIngeni...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Infomación de profesor y grupo para la variable categórica &#39;programa&#39;.</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">])[</span><span class="s1">&#39;programa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>profesor</th>
      <th>IDG</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Agamenón</th>
      <th>G3</th>
      <td>21</td>
      <td>4</td>
      <td>Ingeniería Ambiental</td>
      <td>13</td>
    </tr>
    <tr>
      <th>G5</th>
      <td>21</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Agenor</th>
      <th>G31</th>
      <td>23</td>
      <td>1</td>
      <td>Ingeniería De Sistemas</td>
      <td>23</td>
    </tr>
    <tr>
      <th>Andrómaca</th>
      <th>G19</th>
      <td>19</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Apolo</th>
      <th>G1</th>
      <td>23</td>
      <td>1</td>
      <td>Ingeniería De Sistemas</td>
      <td>23</td>
    </tr>
    <tr>
      <th>Aquiles</th>
      <th>G15</th>
      <td>22</td>
      <td>4</td>
      <td>Ingeniería Electrónica</td>
      <td>13</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Artemisa</th>
      <th>G10</th>
      <td>20</td>
      <td>3</td>
      <td>Ingeniería Ambiental</td>
      <td>16</td>
    </tr>
    <tr>
      <th>G14</th>
      <td>22</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>16</td>
    </tr>
    <tr>
      <th>G7</th>
      <td>20</td>
      <td>5</td>
      <td>Ingeniería Electrónica</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Atenea</th>
      <th>G2</th>
      <td>23</td>
      <td>1</td>
      <td>Ingeniería De Sistemas</td>
      <td>23</td>
    </tr>
    <tr>
      <th>G6</th>
      <td>22</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Briseida</th>
      <th>G25</th>
      <td>17</td>
      <td>3</td>
      <td>Ingeniería Ambiental</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Diomedes</th>
      <th>G13</th>
      <td>19</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Dolón</th>
      <th>G12</th>
      <td>21</td>
      <td>5</td>
      <td>Ingeniería Electrónica</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Eneas</th>
      <th>G20</th>
      <td>8</td>
      <td>5</td>
      <td>Ingeniería Industrial</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Euforbo</th>
      <th>G8</th>
      <td>23</td>
      <td>5</td>
      <td>Ingeniería Electrónica</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Hades</th>
      <th>G9</th>
      <td>24</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>11</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Hefesto</th>
      <th>G33</th>
      <td>21</td>
      <td>3</td>
      <td>Ingeniería Ambiental</td>
      <td>10</td>
    </tr>
    <tr>
      <th>G4</th>
      <td>22</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>9</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Hermes</th>
      <th>G17</th>
      <td>11</td>
      <td>3</td>
      <td>Ingeniería Ambiental</td>
      <td>5</td>
    </tr>
    <tr>
      <th>G30</th>
      <td>13</td>
      <td>4</td>
      <td>Ingeniería Ambiental</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Héctor</th>
      <th>G27</th>
      <td>16</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>7</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Menelao</th>
      <th>G16</th>
      <td>17</td>
      <td>2</td>
      <td>Ingeniería De Sistemas</td>
      <td>16</td>
    </tr>
    <tr>
      <th>G21</th>
      <td>17</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>8</td>
    </tr>
    <tr>
      <th>G24</th>
      <td>15</td>
      <td>5</td>
      <td>Ingeniería Industrial</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Néstor</th>
      <th>G28</th>
      <td>20</td>
      <td>4</td>
      <td>Ingeniería Ambiental</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Odiseo</th>
      <th>G23</th>
      <td>18</td>
      <td>4</td>
      <td>Ingeniería Ambiental</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Paris</th>
      <th>G29</th>
      <td>12</td>
      <td>3</td>
      <td>Ingeniería De Sistemas</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Patroclo</th>
      <th>G11</th>
      <td>23</td>
      <td>4</td>
      <td>Ingeniería Ambiental</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Polidoro</th>
      <th>G32</th>
      <td>24</td>
      <td>3</td>
      <td>Ingeniería Ambiental</td>
      <td>18</td>
    </tr>
    <tr>
      <th>Poseidón</th>
      <th>G22</th>
      <td>12</td>
      <td>4</td>
      <td>Ingeniería Ambiental</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Príamo</th>
      <th>G26</th>
      <td>15</td>
      <td>5</td>
      <td>Ingeniería Ambiental</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Pándarp</th>
      <th>G18</th>
      <td>13</td>
      <td>5</td>
      <td>Ingeniería Electrónica</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Infomación de profesor y grupo para la variable categórica &#39;programa&#39;.</span>
<span class="n">dfge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span><span class="s1">&#39;IDG&#39;</span><span class="p">])[</span><span class="s1">&#39;corte1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>profesor</th>
      <th>IDG</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Agamenón</th>
      <th>G3</th>
      <td>21.0</td>
      <td>4.071429</td>
      <td>0.762983</td>
      <td>1.0</td>
      <td>4.000</td>
      <td>4.00</td>
      <td>4.500</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>G5</th>
      <td>21.0</td>
      <td>3.928571</td>
      <td>0.870140</td>
      <td>1.0</td>
      <td>4.000</td>
      <td>4.00</td>
      <td>4.500</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Agenor</th>
      <th>G31</th>
      <td>23.0</td>
      <td>3.217391</td>
      <td>0.687983</td>
      <td>2.0</td>
      <td>2.750</td>
      <td>3.00</td>
      <td>3.500</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Andrómaca</th>
      <th>G19</th>
      <td>19.0</td>
      <td>3.421053</td>
      <td>1.169795</td>
      <td>0.0</td>
      <td>3.000</td>
      <td>3.50</td>
      <td>4.000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Apolo</th>
      <th>G1</th>
      <td>23.0</td>
      <td>3.586957</td>
      <td>0.972954</td>
      <td>0.5</td>
      <td>3.000</td>
      <td>4.00</td>
      <td>4.000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Aquiles</th>
      <th>G15</th>
      <td>22.0</td>
      <td>2.204545</td>
      <td>0.826050</td>
      <td>0.5</td>
      <td>1.625</td>
      <td>2.50</td>
      <td>2.500</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Artemisa</th>
      <th>G10</th>
      <td>20.0</td>
      <td>2.250000</td>
      <td>1.208522</td>
      <td>0.0</td>
      <td>1.500</td>
      <td>2.50</td>
      <td>3.125</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>G14</th>
      <td>22.0</td>
      <td>2.454545</td>
      <td>0.998917</td>
      <td>0.0</td>
      <td>2.000</td>
      <td>2.50</td>
      <td>3.000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>G7</th>
      <td>20.0</td>
      <td>2.900000</td>
      <td>1.187656</td>
      <td>0.0</td>
      <td>2.000</td>
      <td>3.25</td>
      <td>4.000</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Atenea</th>
      <th>G2</th>
      <td>23.0</td>
      <td>3.456522</td>
      <td>0.767420</td>
      <td>1.0</td>
      <td>3.000</td>
      <td>3.50</td>
      <td>4.000</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>G6</th>
      <td>22.0</td>
      <td>3.250000</td>
      <td>0.767649</td>
      <td>1.5</td>
      <td>2.625</td>
      <td>3.50</td>
      <td>4.000</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Briseida</th>
      <th>G25</th>
      <td>17.0</td>
      <td>3.000000</td>
      <td>1.045825</td>
      <td>1.5</td>
      <td>1.500</td>
      <td>3.50</td>
      <td>4.000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Diomedes</th>
      <th>G13</th>
      <td>19.0</td>
      <td>2.894737</td>
      <td>0.921637</td>
      <td>1.0</td>
      <td>2.500</td>
      <td>3.00</td>
      <td>3.500</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Dolón</th>
      <th>G12</th>
      <td>21.0</td>
      <td>3.285714</td>
      <td>1.707128</td>
      <td>0.0</td>
      <td>3.000</td>
      <td>4.00</td>
      <td>4.500</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Eneas</th>
      <th>G20</th>
      <td>8.0</td>
      <td>2.812500</td>
      <td>1.131923</td>
      <td>1.0</td>
      <td>2.500</td>
      <td>2.50</td>
      <td>3.125</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Euforbo</th>
      <th>G8</th>
      <td>23.0</td>
      <td>3.804348</td>
      <td>0.749835</td>
      <td>2.0</td>
      <td>3.500</td>
      <td>4.00</td>
      <td>4.000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Hades</th>
      <th>G9</th>
      <td>24.0</td>
      <td>3.520833</td>
      <td>0.972214</td>
      <td>0.0</td>
      <td>3.500</td>
      <td>3.50</td>
      <td>4.000</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Hefesto</th>
      <th>G33</th>
      <td>21.0</td>
      <td>4.166667</td>
      <td>0.577350</td>
      <td>3.0</td>
      <td>4.000</td>
      <td>4.50</td>
      <td>4.500</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>G4</th>
      <td>22.0</td>
      <td>4.295455</td>
      <td>0.398183</td>
      <td>3.5</td>
      <td>4.000</td>
      <td>4.50</td>
      <td>4.500</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Hermes</th>
      <th>G17</th>
      <td>11.0</td>
      <td>3.727273</td>
      <td>0.646670</td>
      <td>3.0</td>
      <td>3.250</td>
      <td>3.50</td>
      <td>4.500</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>G30</th>
      <td>13.0</td>
      <td>2.961538</td>
      <td>1.107955</td>
      <td>0.0</td>
      <td>2.500</td>
      <td>3.00</td>
      <td>3.500</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Héctor</th>
      <th>G27</th>
      <td>16.0</td>
      <td>2.406250</td>
      <td>1.344355</td>
      <td>0.0</td>
      <td>1.750</td>
      <td>2.50</td>
      <td>3.125</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Menelao</th>
      <th>G16</th>
      <td>17.0</td>
      <td>2.852941</td>
      <td>1.169464</td>
      <td>0.0</td>
      <td>3.000</td>
      <td>3.00</td>
      <td>3.500</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>G21</th>
      <td>17.0</td>
      <td>2.852941</td>
      <td>0.579997</td>
      <td>2.0</td>
      <td>2.500</td>
      <td>3.00</td>
      <td>3.000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>G24</th>
      <td>15.0</td>
      <td>2.866667</td>
      <td>0.549892</td>
      <td>2.0</td>
      <td>2.500</td>
      <td>3.00</td>
      <td>3.250</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Néstor</th>
      <th>G28</th>
      <td>20.0</td>
      <td>3.425000</td>
      <td>1.844444</td>
      <td>0.0</td>
      <td>3.000</td>
      <td>4.50</td>
      <td>4.500</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Odiseo</th>
      <th>G23</th>
      <td>18.0</td>
      <td>4.166667</td>
      <td>0.342997</td>
      <td>3.5</td>
      <td>4.000</td>
      <td>4.00</td>
      <td>4.500</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Paris</th>
      <th>G29</th>
      <td>12.0</td>
      <td>3.208333</td>
      <td>1.054392</td>
      <td>2.0</td>
      <td>2.500</td>
      <td>2.75</td>
      <td>4.125</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Patroclo</th>
      <th>G11</th>
      <td>23.0</td>
      <td>3.673913</td>
      <td>0.806348</td>
      <td>2.5</td>
      <td>3.000</td>
      <td>4.00</td>
      <td>4.500</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Polidoro</th>
      <th>G32</th>
      <td>24.0</td>
      <td>3.937500</td>
      <td>0.613481</td>
      <td>2.0</td>
      <td>3.500</td>
      <td>4.00</td>
      <td>4.125</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Poseidón</th>
      <th>G22</th>
      <td>12.0</td>
      <td>2.750000</td>
      <td>0.722999</td>
      <td>1.5</td>
      <td>2.375</td>
      <td>2.75</td>
      <td>3.125</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Príamo</th>
      <th>G26</th>
      <td>15.0</td>
      <td>3.700000</td>
      <td>1.192237</td>
      <td>0.0</td>
      <td>3.250</td>
      <td>4.00</td>
      <td>4.500</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Pándarp</th>
      <th>G18</th>
      <td>13.0</td>
      <td>3.269231</td>
      <td>1.348076</td>
      <td>0.0</td>
      <td>2.500</td>
      <td>4.00</td>
      <td>4.000</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grupos por profesor:</span>
<span class="n">df1</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;profesor&#39;</span><span class="p">])[</span><span class="s1">&#39;IDG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>profesor
Agamenón            {G3, G5}
Agenor                 {G31}
Andrómaca              {G19}
Apolo                   {G1}
Aquiles                {G15}
Artemisa      {G14, G7, G10}
Atenea              {G6, G2}
Briseida               {G25}
Diomedes               {G13}
Dolón                  {G12}
Eneas                  {G20}
Euforbo                 {G8}
Hades                   {G9}
Hefesto            {G4, G33}
Hermes            {G30, G17}
Héctor                 {G27}
Menelao      {G24, G16, G21}
Néstor                 {G28}
Odiseo                 {G23}
Paris                  {G29}
Patroclo               {G11}
Polidoro               {G32}
Poseidón               {G22}
Príamo                 {G26}
Pándarp                {G18}
Name: IDG, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3><em><strong>Solución pregunta 3.</strong></em><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p><em>Cuáles son los promedios de calificación en el primer y segundo corte que tienen cada uno de los profesores en los grupos de Ingeniería de Sistemas?</em></p>
<p>Con lo que ya se conoce intente resolver</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Solución pregunta 3.</span>
<span class="n">df_groupby</span> <span class="o">=</span> <span class="n">dfge</span><span class="p">[</span><span class="n">dfge</span><span class="p">[</span><span class="s1">&#39;programa&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Ingeniería De Sistemas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;profesor&#39;</span><span class="p">)[[</span><span class="s1">&#39;corte1&#39;</span><span class="p">,</span><span class="s1">&#39;corte2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df_groupby</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>corte1</th>
      <th>corte2</th>
    </tr>
    <tr>
      <th>profesor</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Agamenón</th>
      <td>3.500000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>Agenor</th>
      <td>3.217391</td>
      <td>2.673913</td>
    </tr>
    <tr>
      <th>Andrómaca</th>
      <td>3.500000</td>
      <td>2.500000</td>
    </tr>
    <tr>
      <th>Apolo</th>
      <td>3.586957</td>
      <td>2.043478</td>
    </tr>
    <tr>
      <th>Artemisa</th>
      <td>3.125000</td>
      <td>2.125000</td>
    </tr>
    <tr>
      <th>Atenea</th>
      <td>3.425926</td>
      <td>2.925926</td>
    </tr>
    <tr>
      <th>Diomedes</th>
      <td>2.250000</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <th>Dolón</th>
      <td>4.000000</td>
      <td>3.166667</td>
    </tr>
    <tr>
      <th>Eneas</th>
      <td>3.750000</td>
      <td>4.500000</td>
    </tr>
    <tr>
      <th>Euforbo</th>
      <td>4.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>Hades</th>
      <td>4.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>Hefesto</th>
      <td>4.250000</td>
      <td>2.250000</td>
    </tr>
    <tr>
      <th>Hermes</th>
      <td>4.500000</td>
      <td>4.500000</td>
    </tr>
    <tr>
      <th>Héctor</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>Menelao</th>
      <td>2.925000</td>
      <td>3.025000</td>
    </tr>
    <tr>
      <th>Paris</th>
      <td>3.350000</td>
      <td>2.900000</td>
    </tr>
    <tr>
      <th>Patroclo</th>
      <td>3.400000</td>
      <td>3.100000</td>
    </tr>
    <tr>
      <th>Polidoro</th>
      <td>3.333333</td>
      <td>3.666667</td>
    </tr>
    <tr>
      <th>Poseidón</th>
      <td>2.500000</td>
      <td>1.750000</td>
    </tr>
    <tr>
      <th>Príamo</th>
      <td>4.500000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>Pándarp</th>
      <td>4.000000</td>
      <td>4.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="solucion-de-la-pregunta-4">
<h3><em><strong>Solución de la pregunta 4</strong></em><a class="headerlink" href="#solucion-de-la-pregunta-4" title="Permalink to this headline">#</a></h3>
<p><em>Qué estudiantes de cada programa han dejado de presentar el examen?</em></p>
<p><strong>Análisis:</strong> Para esta pregunta la información esta en las tablas: ‘examen’ y ‘estudiante’. Al combinar estas dos tablas es necesario forzar a que aparezcan todos los estudiantes incluso los que no presentaron examen. Luego se puede filtrar por aquellos estudiantes que no les aparece nota de examen y se organizan por programa.</p>
<p><strong>Hint</strong>:</p>
<p>Realice los siguientes tres pasos:</p>
<ol class="simple">
<li><p>Enlace las 2 tablas del anaĺisis con <code class="docutils literal notranslate"><span class="pre">how=???</span></code></p></li>
<li><p>Muestre la cantidad de faltantes por carrera con <code class="docutils literal notranslate"><span class="pre">pd.groupby()</span></code></p></li>
<li><p>Construya un dataframe donde se vean los faltantes, el total y % de faltantes.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_examen</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>inicio</th>
      <th>final</th>
      <th>nota</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
      <th>p5</th>
      <th>p6</th>
      <th>p7</th>
      <th>p8</th>
      <th>p9</th>
      <th>p10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1502</td>
      <td>18:30:00</td>
      <td>19:09:00</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1503</td>
      <td>09:05:00</td>
      <td>10:13:00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_examen</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">df_estudiante</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((517, 14), (617, 2))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_estudiante</span><span class="p">[</span><span class="s2">&quot;IDE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">## No tenemos registros repetidos por IDE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1500    1
1914    1
1907    1
1908    1
1909    1
       ..
1707    1
1708    1
1709    1
1710    1
2116    1
Name: IDE, Length: 617, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_examen</span><span class="p">[</span><span class="s2">&quot;IDE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">## Tenemos 2 registros repetidos por IDE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1900    2
1681    2
1502    1
1913    1
1928    1
       ..
1702    1
1701    1
1700    1
1699    1
2115    1
Name: IDE, Length: 515, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_examen</span><span class="p">[</span><span class="n">df_examen</span><span class="p">[</span><span class="s2">&quot;IDE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1900</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>inicio</th>
      <th>final</th>
      <th>nota</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
      <th>p5</th>
      <th>p6</th>
      <th>p7</th>
      <th>p8</th>
      <th>p9</th>
      <th>p10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>332</th>
      <td>1900</td>
      <td>09:25:00</td>
      <td>09:55:00</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>333</th>
      <td>1900</td>
      <td>18:15:00</td>
      <td>19:35:00</td>
      <td>3.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_examen</span><span class="p">[</span><span class="n">df_examen</span><span class="p">[</span><span class="s2">&quot;IDE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1681</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>inicio</th>
      <th>final</th>
      <th>nota</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
      <th>p5</th>
      <th>p6</th>
      <th>p7</th>
      <th>p8</th>
      <th>p9</th>
      <th>p10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>151</th>
      <td>1681</td>
      <td>09:12:00</td>
      <td>10:29:00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>152</th>
      <td>1681</td>
      <td>18:17:00</td>
      <td>19:45:00</td>
      <td>2.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_estudiante</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>programa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1500</td>
      <td>Ingeniería Mecánica</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1501</td>
      <td>Ingeniería Ambiental</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfxe</span> <span class="o">=</span> <span class="n">df_estudiante</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_examen</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">dfxe</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 619 entries, 0 to 618
Data columns (total 15 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   IDE       619 non-null    int64  
 1   programa  619 non-null    object 
 2   inicio    517 non-null    object 
 3   final     517 non-null    object 
 4   nota      517 non-null    float64
 5   p1        517 non-null    float64
 6   p2        517 non-null    float64
 7   p3        517 non-null    float64
 8   p4        517 non-null    float64
 9   p5        517 non-null    float64
 10  p6        516 non-null    float64
 11  p7        517 non-null    float64
 12  p8        517 non-null    float64
 13  p9        517 non-null    float64
 14  p10       517 non-null    float64
dtypes: float64(11), int64(1), object(3)
memory usage: 77.4+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfxe</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDE</th>
      <th>programa</th>
      <th>inicio</th>
      <th>final</th>
      <th>nota</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
      <th>p5</th>
      <th>p6</th>
      <th>p7</th>
      <th>p8</th>
      <th>p9</th>
      <th>p10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1500</td>
      <td>Ingeniería Mecánica</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1501</td>
      <td>Ingeniería Ambiental</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1502</td>
      <td>Ingeniería De Sistemas</td>
      <td>18:30:00</td>
      <td>19:09:00</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1503</td>
      <td>Ingeniería Ambiental</td>
      <td>09:05:00</td>
      <td>10:13:00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1504</td>
      <td>Ingeniería Ambiental</td>
      <td>09:24:00</td>
      <td>10:04:00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1505</td>
      <td>Ingeniería De Sistemas</td>
      <td>09:09:00</td>
      <td>09:48:00</td>
      <td>5.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1506</td>
      <td>Ingeniería Ambiental</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1507</td>
      <td>Ingeniería Ambiental</td>
      <td>18:36:00</td>
      <td>19:00:00</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1508</td>
      <td>Ingeniería De Sistemas</td>
      <td>18:17:00</td>
      <td>19:32:00</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1509</td>
      <td>Ingeniería Industrial</td>
      <td>09:15:00</td>
      <td>10:37:00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">dfxe</span><span class="p">[</span><span class="s2">&quot;nota&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Serie de pandas a dataframe.</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">dfxe</span><span class="p">[</span><span class="s2">&quot;nota&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">df_temp</span> <span class="o">=</span> <span class="n">dfxe</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;programa&quot;</span><span class="p">)[</span><span class="s2">&quot;IDE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_temp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 programa  IDE
0     Ingeniería Mecánica    9
1   Ingeniería Industrial   11
2  Ingeniería Electrónica   19
3  Ingeniería De Sistemas   20
4    Ingeniería Ambiental   43
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Una posible solución.</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">dfxe</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;programa&#39;</span><span class="p">)[</span><span class="s1">&#39;IDE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">dfxe</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de tabla: &#39;</span><span class="p">,</span><span class="n">df1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;programa&#39;</span><span class="p">)[</span><span class="s1">&#39;IDE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;IDE&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">df2</span><span class="o">.</span><span class="n">IDE</span><span class="o">/</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tamaño de tabla:  (102, 15)
                        IDE  total    percent
programa                                     
Ingeniería Ambiental     43    231  18.614719
Ingeniería De Sistemas   20    144  13.888889
Ingeniería Electrónica   19    110  17.272727
Ingeniería Industrial    11     78  14.102564
Ingeniería Mecánica       9     56  16.071429
</pre></div>
</div>
</div>
</div>
</section>
<section id="solucion-pregunta-5">
<h3><em><strong>Solución pregunta 5.</strong></em><a class="headerlink" href="#solucion-pregunta-5" title="Permalink to this headline">#</a></h3>
<p><em>Cuáles de los estudiantes que presentaron el examen no aparecen en el listado?</em></p>
<p>Con lo que ya conoce trate de resolver este punto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Primero notemos que todos los estudiantes que presentaron el examen están en el listado</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El tamaño del dataframe df_examen es:&quot;</span><span class="p">,</span><span class="n">df_examen</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El tamaño del dataframe df_listado es:&quot;</span><span class="p">,</span><span class="n">df_listado</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El tamaño del dataframe con inner join es:&quot;</span><span class="p">,</span> <span class="n">df_examen</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_listado</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El tamaño del dataframe df_examen es: (517, 14)
El tamaño del dataframe df_listado es: (617, 7)
El tamaño del dataframe con inner join es: (517, 20)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## ¿Porqué aumenta el número de registros?</span>
<span class="n">df_listado</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_examen</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(619, 20)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># celda de código para probar</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="manejo-de-tablas-pivote">
<h2><em><strong>Manejo de Tablas Pivote</strong></em><a class="headerlink" href="#manejo-de-tablas-pivote" title="Permalink to this headline">#</a></h2>
<p>Las <code class="docutils literal notranslate"><span class="pre">Pivot</span> <span class="pre">table</span></code> son tablas de datos de resumen. Estas tablas permiten agrupar información para el análisis de datos. La agrupación de información es posible en filas y columnas, lo cual resulta muy útil para cruzar categorías de diferentes características. Con la información de cruce se calculan diferentes estadísticas, como por ejemplo: suma, promedio, desviación, varianza, entre otros para variables numéricas. Así como también, conteos, cantidad de valores únicos, moda, entre otras para variables de tipo categórico.</p>
<p>Antes de usar una <code class="docutils literal notranslate"><span class="pre">Pivot</span> <span class="pre">Table</span></code>, es necesario que se tenga una completa compresión de la estructura de sus datos, la descripción de cada una de las columnas que tiene y los posibles valores que estas puedan tomar y que va usar en el procesamiento de los datos. Luego de entender los datos, ahora debe comprender la pregunta que está intentando resolver mediante una <code class="docutils literal notranslate"><span class="pre">Pivot</span> <span class="pre">table</span></code>.</p>
<section id="el-metodo-pivot-table">
<h3>El método: <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code><a class="headerlink" href="#el-metodo-pivot-table" title="Permalink to this headline">#</a></h3>
<p>A continuación se mencionan los parámetros más importantes de la función:</p>
<ul class="simple">
<li><p><strong>dataframe:</strong> es necesario antes crear una tabla con todos los datos que se van a trabajar.</p></li>
<li><p><strong>index:</strong> lista de columnas que serán utilizadas para agrupar por filas</p></li>
<li><p><strong>columns:</strong> lista de columnas que se utilizarán para agrupar por columnas, con las categorias de las filas</p></li>
<li><p><strong>values:</strong> (opcional) lista de columnas que serán utilizadas para resumir la información</p></li>
<li><p><strong>aggfunc:</strong> Lista de funciones que se utilizan para agregar los valores.</p></li>
<li><p><strong>fill_value:</strong> valor para reemplazar valores nulos</p></li>
<li><p><strong>margins:</strong> Para agregar subtotales a las filas y columnas, parciales o totales.</p></li>
</ul>
<p>Para información adicional de pivot tables <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.09-pivot-tables.html">python datascience notebook</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;titanic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)[[</span><span class="s1">&#39;fare&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fare</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>44.479818</td>
    </tr>
    <tr>
      <th>male</th>
      <td>25.523893</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">])[</span><span class="s1">&#39;survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    549
1    342
Name: survived, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">age</span><span class="p">],</span> <span class="s1">&#39;class&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th>age</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">female</th>
      <th>(0, 18]</th>
      <td>0.909091</td>
      <td>1.000000</td>
      <td>0.511628</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>0.972973</td>
      <td>0.900000</td>
      <td>0.423729</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">male</th>
      <th>(0, 18]</th>
      <td>0.800000</td>
      <td>0.600000</td>
      <td>0.215686</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>0.375000</td>
      <td>0.071429</td>
      <td>0.133663</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fare</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;fare&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">age</span><span class="p">],</span> <span class="p">[</span><span class="n">fare</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>fare</th>
      <th colspan="3" halign="left">(-0.001, 14.454]</th>
      <th colspan="3" halign="left">(14.454, 512.329]</th>
    </tr>
    <tr>
      <th></th>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th>age</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">female</th>
      <th>(0, 18]</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>0.714286</td>
      <td>0.909091</td>
      <td>1.000000</td>
      <td>0.318182</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>NaN</td>
      <td>0.880000</td>
      <td>0.444444</td>
      <td>0.972973</td>
      <td>0.914286</td>
      <td>0.391304</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">male</th>
      <th>(0, 18]</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.260870</td>
      <td>0.800000</td>
      <td>0.818182</td>
      <td>0.178571</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>0.0</td>
      <td>0.098039</td>
      <td>0.125000</td>
      <td>0.391304</td>
      <td>0.030303</td>
      <td>0.192308</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;survived&#39;</span><span class="p">:</span><span class="nb">sum</span><span class="p">,</span> <span class="s1">&#39;fare&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">fare</th>
      <th colspan="3" halign="left">survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>106.125798</td>
      <td>21.970121</td>
      <td>16.118810</td>
      <td>91</td>
      <td>70</td>
      <td>72</td>
    </tr>
    <tr>
      <th>male</th>
      <td>67.226127</td>
      <td>19.741782</td>
      <td>12.661633</td>
      <td>45</td>
      <td>17</td>
      <td>47</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>All</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
      <td>0.742038</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
      <td>0.188908</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.629630</td>
      <td>0.472826</td>
      <td>0.242363</td>
      <td>0.383838</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="s1">&#39;survived&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                    <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">f</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">mean</th>
      <th colspan="4" halign="left">&lt;lambda&gt;</th>
    </tr>
    <tr>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>All</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>All</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
      <td>0.742038</td>
      <td>0.031915</td>
      <td>0.078947</td>
      <td>0.500000</td>
      <td>0.257962</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
      <td>0.188908</td>
      <td>0.631148</td>
      <td>0.842593</td>
      <td>0.864553</td>
      <td>0.811092</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.629630</td>
      <td>0.472826</td>
      <td>0.242363</td>
      <td>0.383838</td>
      <td>0.370370</td>
      <td>0.527174</td>
      <td>0.757637</td>
      <td>0.616162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="ejemplo-pivot-table-1">
<h3>Ejemplo pivot_table 1<a class="headerlink" href="#ejemplo-pivot-table-1" title="Permalink to this headline">#</a></h3>
<p><strong>Problema:</strong> Se requiere saber el promedio de las notas del corte 1 y corte 2 agrupadas por profesor y número del grupo (en filas) y clasficadas por el nombre del programa (en columnas).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dfel</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># Estudiante y listado</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfgp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># Grupo y profesor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    IDE              programa  IDG  corte1  corte2  prom  fallas  fallaP
0  1500   Ingeniería Mecánica   G5     1.0     1.0   1.0       0    0.00
1  1501  Ingeniería Ambiental  G12     0.0     0.0   0.0      12   70.59
  IDG                      curso  creditos  IDP  nestud  periodo   año  \
4  G5  Algoritmos y programación         3  210      21        2  2017   
3  G3  Algoritmos y programación         3  210      21        2  2017   

  jornada  profesor dedicacion  
4     día  Agamenón    Cátedra  
3     día  Agamenón    Cátedra  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merge</span> <span class="o">=</span> <span class="n">dfel</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfgp</span><span class="p">)</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;IDE&#39;, &#39;programa&#39;, &#39;IDG&#39;, &#39;corte1&#39;, &#39;corte2&#39;, &#39;prom&#39;, &#39;fallas&#39;,
       &#39;fallaP&#39;, &#39;curso&#39;, &#39;creditos&#39;, &#39;IDP&#39;, &#39;nestud&#39;, &#39;periodo&#39;, &#39;año&#39;,
       &#39;jornada&#39;, &#39;profesor&#39;, &#39;dedicacion&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># celda para probar</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;corte1&#39;</span><span class="p">,</span><span class="s1">&#39;corte2&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;IDG&#39;</span><span class="p">,</span><span class="s2">&quot;profesor&quot;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;programa&quot;</span><span class="p">,</span>
                     <span class="n">fill_value</span> <span class="o">=</span> <span class="s2">&quot;S/E&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="5" halign="left">corte1</th>
      <th colspan="5" halign="left">corte2</th>
    </tr>
    <tr>
      <th></th>
      <th>programa</th>
      <th>Ingeniería Ambiental</th>
      <th>Ingeniería De Sistemas</th>
      <th>Ingeniería Electrónica</th>
      <th>Ingeniería Industrial</th>
      <th>Ingeniería Mecánica</th>
      <th>Ingeniería Ambiental</th>
      <th>Ingeniería De Sistemas</th>
      <th>Ingeniería Electrónica</th>
      <th>Ingeniería Industrial</th>
      <th>Ingeniería Mecánica</th>
    </tr>
    <tr>
      <th>IDG</th>
      <th>profesor</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>G1</th>
      <th>Apolo</th>
      <td>S/E</td>
      <td>3.586957</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>2.043478</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G10</th>
      <th>Artemisa</th>
      <td>2.09375</td>
      <td>2.0</td>
      <td>S/E</td>
      <td>3.166667</td>
      <td>S/E</td>
      <td>1.3125</td>
      <td>0.0</td>
      <td>S/E</td>
      <td>2.333333</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G11</th>
      <th>Patroclo</th>
      <td>3.357143</td>
      <td>3.4</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>S/E</td>
      <td>2.5</td>
      <td>3.1</td>
      <td>3.6</td>
      <td>3.25</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G12</th>
      <th>Dolón</th>
      <td>2.142857</td>
      <td>4.0</td>
      <td>3.5625</td>
      <td>4.75</td>
      <td>4.0</td>
      <td>1.571429</td>
      <td>3.166667</td>
      <td>3.4375</td>
      <td>4.75</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>G13</th>
      <th>Diomedes</th>
      <td>3.4</td>
      <td>2.25</td>
      <td>2.0</td>
      <td>3.5</td>
      <td>2.5</td>
      <td>3.15</td>
      <td>1.5</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>G14</th>
      <th>Artemisa</th>
      <td>2.3125</td>
      <td>3.0</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.59375</td>
      <td>3.5</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>G15</th>
      <th>Aquiles</th>
      <td>1.9</td>
      <td>S/E</td>
      <td>2.269231</td>
      <td>2.0</td>
      <td>2.75</td>
      <td>1.3</td>
      <td>S/E</td>
      <td>2.346154</td>
      <td>1.5</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>G16</th>
      <th>Menelao</th>
      <td>3.0</td>
      <td>2.84375</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>3.5</td>
      <td>2.96875</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G17</th>
      <th>Hermes</th>
      <td>3.3</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>3.666667</td>
      <td>4.5</td>
      <td>3.8</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>4.333333</td>
      <td>4.833333</td>
    </tr>
    <tr>
      <th>G18</th>
      <th>Pándarp</th>
      <td>3.5</td>
      <td>4.0</td>
      <td>3.25</td>
      <td>4.166667</td>
      <td>1.0</td>
      <td>3.75</td>
      <td>4.5</td>
      <td>2.25</td>
      <td>3.833333</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>G19</th>
      <th>Andrómaca</th>
      <td>2.714286</td>
      <td>3.5</td>
      <td>4.0</td>
      <td>3.5</td>
      <td>4.0</td>
      <td>2.142857</td>
      <td>2.5</td>
      <td>2.8</td>
      <td>3.25</td>
      <td>4.333333</td>
    </tr>
    <tr>
      <th>G2</th>
      <th>Atenea</th>
      <td>S/E</td>
      <td>3.456522</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>2.934783</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G20</th>
      <th>Eneas</th>
      <td>3.5</td>
      <td>3.75</td>
      <td>1.0</td>
      <td>2.666667</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>4.5</td>
      <td>0.0</td>
      <td>4.5</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>G21</th>
      <th>Menelao</th>
      <td>2.5625</td>
      <td>4.0</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>2.833333</td>
      <td>2.875</td>
      <td>4.0</td>
      <td>3.5</td>
      <td>2.625</td>
      <td>3.333333</td>
    </tr>
    <tr>
      <th>G22</th>
      <th>Poseidón</th>
      <td>3.071429</td>
      <td>2.5</td>
      <td>2.0</td>
      <td>S/E</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>1.75</td>
      <td>0.0</td>
      <td>S/E</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>G23</th>
      <th>Odiseo</th>
      <td>4.25</td>
      <td>S/E</td>
      <td>4.083333</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>3.416667</td>
      <td>S/E</td>
      <td>4.0</td>
      <td>3.8</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>G24</th>
      <th>Menelao</th>
      <td>3.5</td>
      <td>3.0</td>
      <td>2.75</td>
      <td>3.1</td>
      <td>2.375</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>1.25</td>
      <td>2.9</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>G25</th>
      <th>Briseida</th>
      <td>2.821429</td>
      <td>S/E</td>
      <td>3.75</td>
      <td>4.0</td>
      <td>S/E</td>
      <td>2.857143</td>
      <td>S/E</td>
      <td>4.25</td>
      <td>3.0</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G26</th>
      <th>Príamo</th>
      <td>3.3125</td>
      <td>4.5</td>
      <td>4.5</td>
      <td>3.875</td>
      <td>4.5</td>
      <td>3.1875</td>
      <td>4.0</td>
      <td>4.5</td>
      <td>3.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>G27</th>
      <th>Héctor</th>
      <td>2.142857</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>2.75</td>
      <td>2.5</td>
      <td>1.857143</td>
      <td>0.0</td>
      <td>2.666667</td>
      <td>2.5</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>G28</th>
      <th>Néstor</th>
      <td>3.0625</td>
      <td>S/E</td>
      <td>3.5</td>
      <td>4.75</td>
      <td>3.375</td>
      <td>3.125</td>
      <td>S/E</td>
      <td>3.166667</td>
      <td>4.0</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>G29</th>
      <th>Paris</th>
      <td>3.0</td>
      <td>3.35</td>
      <td>S/E</td>
      <td>2.0</td>
      <td>S/E</td>
      <td>3.0</td>
      <td>2.9</td>
      <td>S/E</td>
      <td>3.5</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G3</th>
      <th>Agamenón</th>
      <td>4.192308</td>
      <td>1.0</td>
      <td>S/E</td>
      <td>4.25</td>
      <td>4.333333</td>
      <td>2.923077</td>
      <td>1.0</td>
      <td>S/E</td>
      <td>3.5</td>
      <td>3.166667</td>
    </tr>
    <tr>
      <th>G30</th>
      <th>Hermes</th>
      <td>2.625</td>
      <td>4.5</td>
      <td>S/E</td>
      <td>3.5</td>
      <td>3.166667</td>
      <td>3.5</td>
      <td>4.5</td>
      <td>S/E</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>G31</th>
      <th>Agenor</th>
      <td>S/E</td>
      <td>3.217391</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>2.673913</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G32</th>
      <th>Polidoro</th>
      <td>4.0</td>
      <td>3.333333</td>
      <td>4.166667</td>
      <td>S/E</td>
      <td>S/E</td>
      <td>3.416667</td>
      <td>3.666667</td>
      <td>4.833333</td>
      <td>S/E</td>
      <td>S/E</td>
    </tr>
    <tr>
      <th>G33</th>
      <th>Hefesto</th>
      <td>4.4</td>
      <td>S/E</td>
      <td>4.214286</td>
      <td>S/E</td>
      <td>3.5</td>
      <td>3.6</td>
      <td>S/E</td>
      <td>3.857143</td>
      <td>S/E</td>
      <td>3.75</td>
    </tr>
    <tr>
      <th>G4</th>
      <th>Hefesto</th>
      <td>4.444444</td>
      <td>4.25</td>
      <td>4.25</td>
      <td>4.333333</td>
      <td>3.75</td>
      <td>3.388889</td>
      <td>2.25</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>G5</th>
      <th>Agamenón</th>
      <td>3.875</td>
      <td>4.125</td>
      <td>4.1</td>
      <td>4.25</td>
      <td>3.0</td>
      <td>2.8125</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>G6</th>
      <th>Atenea</th>
      <td>3.25</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>3.0</td>
      <td>3.166667</td>
      <td>2.8125</td>
      <td>2.875</td>
      <td>4.5</td>
      <td>1.5</td>
      <td>2.833333</td>
    </tr>
    <tr>
      <th>G7</th>
      <th>Artemisa</th>
      <td>2.25</td>
      <td>3.75</td>
      <td>3.4375</td>
      <td>2.6</td>
      <td>1.0</td>
      <td>0.625</td>
      <td>2.5</td>
      <td>2.3125</td>
      <td>1.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>G8</th>
      <th>Euforbo</th>
      <td>3.75</td>
      <td>4.0</td>
      <td>3.772727</td>
      <td>3.833333</td>
      <td>4.0</td>
      <td>2.625</td>
      <td>4.0</td>
      <td>3.363636</td>
      <td>3.583333</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>G9</th>
      <th>Hades</th>
      <td>3.681818</td>
      <td>4.0</td>
      <td>2.333333</td>
      <td>3.4</td>
      <td>4.0</td>
      <td>3.090909</td>
      <td>3.0</td>
      <td>2.5</td>
      <td>2.6</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="uso-de-pivot-table">
<h3>Uso de pivot_table<a class="headerlink" href="#uso-de-pivot-table" title="Permalink to this headline">#</a></h3>
<p>Aplicamos la función sobre los datos preparados:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfr</span> <span class="o">=</span> <span class="n">dfl</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span> <span class="s1">&#39;IDG&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;programa&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;corte1&#39;</span><span class="p">,</span> <span class="s1">&#39;corte2&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<span class="n">dfr</span>
</pre></div>
</div>
<p>Ahora le agregamos totales de fila y de columna a los resultados</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfr</span> <span class="o">=</span> <span class="n">dfl</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;profesor&#39;</span><span class="p">,</span> <span class="s1">&#39;IDG&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;programa&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;corte1&#39;</span><span class="p">,</span> <span class="s1">&#39;corte2&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span>\
                       <span class="n">margins_name</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dfr</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># celda de código para probar</span>
<span class="c1">#dfr = dfl.pivot_table(index=[&#39;profesor&#39;, &#39;IDG&#39;], columns=&#39;programa&#39;, values=[&#39;corte1&#39;, &#39;corte2&#39;],</span>
<span class="c1">#                      aggfunc=np.mean, margins=&#39;All&#39;,margins_name=&#39;Total&#39;, dropna=True, fill_value=-1)</span>
<span class="c1">#dfr</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ejemplo-pivot-table-2">
<h3>Ejemplo pivot table 2<a class="headerlink" href="#ejemplo-pivot-table-2" title="Permalink to this headline">#</a></h3>
<p><strong>Problema:</strong> Ahora se quiere saber la cantidad de estudiantes a cargo de cada profesor agrupado por dedicación y profesor (en filas) clasificada por el nombre de programa (en columnas).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfr</span> <span class="o">=</span> <span class="n">dfl</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dedicacion&#39;</span><span class="p">,</span><span class="s1">&#39;profesor&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;programa&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nestud&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">margins_name</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dfr</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># celda para probar</span>
<span class="c1">#dfr = dfl.pivot_table(index=[&#39;dedicacion&#39;,&#39;profesor&#39;], columns=&#39;programa&#39;, values=[&#39;nestud&#39;], </span>
<span class="c1">#                      aggfunc=np.sum, margins=&#39;All&#39;, margins_name=&#39;Total&#39;, dropna=True, fill_value=0)</span>
<span class="c1">#dfr</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="ejercicios">
<h2><em><strong>Ejercicios.</strong></em><a class="headerlink" href="#ejercicios" title="Permalink to this headline">#</a></h2>
<p>Con los datos suminstrados se requiere resolver las siguientes inquietudes:</p>
<ol class="simple">
<li><p>Se quiere hacer un ranking de profesores de acuerdo con el promedio de nota de sus estudiantes</p></li>
<li><p>Se quiere saber cuáles fueron los estudiantes que pasaron el examen con más o igual a 4.0, con qué profesor estaban, de qué jornada son y a qué grupo pertenecen</p></li>
<li><p>Saber cuáles fueron los promedios de examen por jornada y por carrera y ordenados por promedio.</p></li>
<li><p>Se quiere comparar los estudiantes que presentaron el examen respecto al tiempo que tardaron. Comparar promedios de las calificaciones de los 40 más rápidos contra los 40 más lentos.</p></li>
<li><p>Se quiere saber por profesor cuantos pasaron (nota &gt;= 3) el examen y cuantos los perdieron.</p></li>
<li><p>Se quiere organizar las preguntas de la más difícil a la más fácil de acuerdo a como respondieron en el examen.</p></li>
<li><p>Formule dos preguntas acerca de los datos en donde tenga que aplicar ordenamiento, filtrado, agrupación y cruce de datos.</p></li>
<li><p>Responda las preguntas que planteó en el punto anterior.</p></li>
</ol>
</section>
<section id="tarea-revisar">
<h2>Tarea: revisar:<a class="headerlink" href="#tarea-revisar" title="Permalink to this headline">#</a></h2>
<section id="manejo-de-datos-duplicados">
<h3>1. Manejo de datos duplicados<a class="headerlink" href="#manejo-de-datos-duplicados" title="Permalink to this headline">#</a></h3>
<p>Los dataframes tienen la posibilidad de detectar las filas duplicadas con la función:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">({</span><span class="n">columns</span><span class="p">})</span>
</pre></div>
</div>
<p>Si no especifica {columns}, se busacarán duplicados teniendo en cuenta todas las columnas. Una vez detectados el dtaframe tiene un función para eliminar filas duplicadas, haciendo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
<p>También es posible eliminar filas que duplican solo algunos campos. Con el fin de dejar solo una ocurrencia.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;apellido&#39;</span><span class="p">,</span> <span class="s1">&#39;cédula&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>En este caso, como no todas las colomnas son iguales se conserva solo la última ocurrencia.</p>
</section>
<section id="manejo-de-datos-perdidos-o-esperados">
<h3>2. Manejo de datos perdidos o esperados<a class="headerlink" href="#manejo-de-datos-perdidos-o-esperados" title="Permalink to this headline">#</a></h3>
<p>Son aquellos datos flatantes en la tabla que por alguna razón o error no se encuentran, o parecen con algún valor o etiqueta de no válido.
Para reemplazar datos perdidos en un dataframe <code class="docutils literal notranslate"><span class="pre">df</span></code> se usa la función:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">promedio</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;nota&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;nota&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">promedio</span><span class="p">)</span>
</pre></div>
</div>
<p>en donde la opción <code class="docutils literal notranslate"><span class="pre">promedio</span></code> busca el valor promedio de la columna (datos numéricos).</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Lectura_6.1_operacionesB%C3%A1sicasDataframes.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Operaciones básicas con dataframes</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Lectura_8_procesamientoDeCadenasDeTexto.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Manipulación de cadenas de texto.</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Luis Andres Campos.<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>